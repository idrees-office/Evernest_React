import{X as y,u as H,r as l,a as F,c as G,T as J,s as K,Y as N,j as r,b as e,P as Q,O as Z,e as V,A as ee,S as c}from"./index-b9ec9dcf.js";import{I as te,a as S}from"./IconNotesEdit-158ce9e5.js";import{I as o}from"./IconSquareRotated-7c61424f.js";import{I as re}from"./IconPlus-31ec1e2a.js";import{I as ae}from"./IconHorizontalDots-b53316dd.js";import{I}from"./IconTrashLines-5e27f608.js";import{I as le}from"./IconCalendar-5f4119f0.js";import{A as se}from"./ApprovalModal-2501b51b.js";import{Y as w,y as q}from"./transition-aacbdc25.js";import"./index-c32617a6.js";/* empty css                  */import"./react-select.esm-2d7c3b33.js";import"./objectWithoutPropertiesLoose-f3b3ace0.js";import"./extends-4c19d496.js";import"./floating-ui.dom.browser.min-b8726d47.js";const k={listApi:`${y()}/activities/agents_activities`,deleteApi:`${y()}/activities/delete_activities`,aprovalActivitesApi:`${y()}/activities/aproval_activities`},we=()=>{const R=H(),[A,$]=l.useState([]),[j,m]=l.useState(!1),b=l.useRef(!1),[C,d]=l.useState(!1),[h,_]=l.useState(!1);l.useState(!1);const[s,T]=l.useState("all"),[M,D]=l.useState(null),[L,p]=l.useState(!1),[g,E]=l.useState(null),u=F(t=>t.auth.user||{}),[ne,P]=l.useState({}),z=G(),v=J();l.useEffect(()=>{b.current||(R(K("Activities Request")),f(s)),b.current=!0},[]),l.useEffect(()=>{b.current&&f(s)},[s]);const f=async(t="all")=>{m(!0);try{const n=await N.get(k.listApi,{params:{filter:t}});if(n.status==200||n.status===201){const a=n.data;$(a)}}catch(n){console.error("Error fetching activities:",n),v.error("Failed to fetch activities")}finally{m(!1)}},O=t=>{D(t),d(!0)},Y=async()=>{m(!0);try{const t=await N.delete(`${k.deleteApi}/${M.id}`);(t.status==200||t.status===201)&&(f(s),U("Activity has been deleted successfully."),d(!1))}catch(t){if(t.status===404){c.fire({icon:"warning",title:"Incomplete Activity Request",text:""+t.response.data.message}),d(!1);return}}finally{m(!1)}},U=(t="",n="success")=>{c.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:3e3,customClass:{container:"toast"}}).fire({icon:n,title:t,padding:"10px 20px"})};F(t=>t.themeConfig.rtlClass);const B=t=>{if(t.status==2){v.warning("This request has already been approved");return}else if(t.status==3){v.warning("This request has already been rejected");return}E(t),p(!0)},W=async t=>{var n;try{const a=new FormData;a.append("id",g.id),a.append("approved_by",u.client_user_id),a.append("action",t.action),t.action==="approve"&&(t.approved_start_date&&a.append("approved_start_date",t.approved_start_date),t.approved_end_date&&a.append("approved_end_date",t.approved_end_date)),a.append("response",t.response);const x=await N.post(k.aprovalActivitesApi,a);(x.status===200||x.status===201)&&(f(s),P({}),c.fire("Success!",x.data.message,"success"),p(!1))}catch(a){((n=a.response)==null?void 0:n.status)===422?c.fire("Error",a.response.data.message||"Validation failed.","error"):c.fire("Error","Something went wrong.","error"),p(!1)}},X=()=>{z("/pages/activities/activities")},i=t=>{T(t)};return r("div",{children:[r("div",{className:"flex gap-5 relative sm:h-[calc(100vh_-_150px)] h-full",children:[e("div",{className:`bg-black/60 z-10 w-full h-full rounded-md absolute hidden ${h?"!block xl:!hidden":""}`,onClick:()=>_(!h)}),r("div",{className:`panel p-4 flex-none w-[240px] absolute xl:relative z-10 space-y-4 h-full xl:h-auto hidden xl:block ltr:lg:rounded-r-md ltr:rounded-r-none rtl:lg:rounded-l-md rtl:rounded-l-none overflow-hidden ${h?"!block h-full ltr:left-0 rtl:right-0":"hidden shadow"}`,children:[r("div",{className:"flex flex-col h-full pb-16",children:[r("div",{className:"flex text-center items-center",children:[e("div",{className:"shrink-0",children:e(te,{})}),e("h3",{className:"text-lg font-semibold ltr:ml-3 rtl:mr-3",children:"Request"})]}),e("div",{className:"h-px w-full border-b border-white-light dark:border-[#1b2e4b] my-4"}),e(Q,{className:"relative ltr:pr-3.5 rtl:pl-3.5 ltr:-mr-3.5 rtl:-ml-3.5 h-full grow",children:r("div",{className:"space-y-1",children:[e("button",{type:"button",className:`w-full flex justify-between items-center p-2 hover:bg-white-dark/10 rounded-md dark:hover:text-primary hover:text-primary dark:hover:bg-[#181F32] font-medium h-10 ${s==="all"&&"bg-gray-100 dark:text-primary text-primary dark:bg-[#181F32]"}`,onClick:()=>i("all"),children:r("div",{className:"flex items-center",children:[e(S,{className:"shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"All Requests"})]})}),e("div",{className:"h-px w-full border-b border-white-light dark:border-[#1b2e4b]"}),e("div",{className:"px-1 py-3 text-white-dark",children:"Filters"}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-info ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="nextweek"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("nextweek"),children:[e(o,{className:"fill-info shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Next Week"})]}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-danger ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="nextmonth"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("nextmonth"),children:[e(o,{className:"fill-danger shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Next Month"})]}),e("div",{className:"pt-3 border-t"}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-primary ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="today"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("today"),children:[e(o,{className:"fill-primary shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Today Request"})]}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-warning ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="yesterday"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("yesterday"),children:[e(o,{className:"fill-warning shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Yesterday Request"})]}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-info ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="week"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("week"),children:[e(o,{className:"fill-info shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Last 1 Week Requests"})]}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-danger ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="month"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("month"),children:[e(o,{className:"fill-danger shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Last Month Requests"})]}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-primary ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="3months"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("3months"),children:[e(o,{className:"fill-primary shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Last 3 Month Requests"})]}),r("button",{type:"button",className:`w-full flex items-center h-10 p-1 hover:bg-white-dark/10 rounded-md dark:hover:bg-[#181F32] font-medium text-danger ltr:hover:pl-3 rtl:hover:pr-3 duration-300 ${s==="6months"&&"ltr:pl-3 rtl:pr-3 bg-gray-100 dark:bg-[#181F32]"}`,onClick:()=>i("6months"),children:[e(o,{className:"fill-danger shrink-0"}),e("div",{className:"ltr:ml-3 rtl:mr-3",children:"Last 6 Month Requests"})]})]})})]}),e("div",{className:"ltr:left-0 rtl:right-0 absolute bottom-0 p-4 w-full",children:r("button",{className:"btn btn-primary w-full",type:"button",onClick:X,children:[e(re,{className:"w-5 h-5 ltr:mr-2 rtl:ml-2 shrink-0"})," Add New Request"]})})]}),r("div",{className:"panel flex-1 overflow-auto h-full",children:[e("div",{className:"pb-5",children:e("button",{type:"button",className:"xl:hidden hover:text-primary",onClick:()=>_(!h),children:e(Z,{})})}),j?e("div",{className:"flex justify-center items-center sm:min-h-[300px] min-h-[400px]",children:e("span",{className:"animate-[spin_2s_linear_infinite] border-4 border-[#f1f2f3] border-l-primary border-r-primary rounded-full w-10 h-10 inline-block align-middle m-auto mb-10"})}):A.length?e("div",{className:"sm:min-h-[300px] min-h-[400px]",children:e("div",{className:"grid 2xl:grid-cols-4 lg:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-5",children:A.map(t=>{var n;return e("div",{className:`panel pb-5 ${t.tag==="personal"?"bg-primary-light shadow-primary":t.tag==="work"?"bg-warning-light shadow-warning":t.tag==="social"?"bg-info-light shadow-info":t.tag==="important"?"bg-danger-light shadow-danger":"dark:shadow-dark"}`,children:r("div",{className:"flex flex-col h-full",children:[r("div",{className:"flex justify-between items-start mb-4",children:[r("div",{className:"flex items-center space-x-3",children:[t.thumb?e("div",{className:"p-1 bg-white rounded-full shadow-sm",children:e("img",{className:"h-10 w-10 rounded-full object-cover border-2 border-white",alt:"User thumbnail",src:`/assets/images/${t.thumb}`})}):t.user?e("div",{className:"flex items-center justify-center h-10 w-10 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 text-white font-semibold shadow-sm",children:t.user.charAt(0)+((n=t.user.split(" ")[1])==null?void 0:n.charAt(0))||""}):e("div",{className:"flex items-center justify-center h-10 w-10 rounded-full bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300",children:e(V,{className:"w-5 h-5"})}),r("div",{children:[e("h3",{className:"font-semibold text-gray-800 dark:text-gray-100",children:t.title}),e("div",{className:"flex flex-wrap gap-2 mt-1",children:t.agents.length===1?e("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:t.agents[0].client_user_name}):t.agents.map(a=>r("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 rounded-full",children:[" ",a.client_user_name," "]},a.client_user_id))})]})]}),(u==null?void 0:u.roles[0].name)==="super admin"&&e("div",{className:"dropdown",children:e("button",{onClick:()=>B(t),className:"p-1 rounded-full hover:bg-gray-100 dark:hover:bg-gray-600",children:e(ae,{className:"w-5 h-5 opacity-70 hover:opacity-100"})})})]}),r("div",{className:"flex-grow mb-6",children:[e("h4",{className:"font-semibold text-gray-800 dark:text-gray-100 mb-2",children:t.title}),e("p",{className:"text-gray-600 dark:text-gray-300 text-sm leading-relaxed",children:t.description})]}),e("div",{className:"flex items-center justify-end mt-auto mb-2",children:e("span",{className:`text-xs font-medium px-2.5 py-0.5 rounded ${t.status===1?"bg-secondary text-white":t.status===2?"bg-success text-white":t.status===3?"bg-danger text-white":""}`,children:t.status===1?"Pending to Approve":t.status===2?"Approved":t.status===3?"Rejected":""})}),r("div",{className:"flex items-center justify-between mt-auto pt-3 border-t",children:[r("div",{className:"flex items-center text-sm",children:[e(le,{className:"w-4 h-4 mr-1 text-primary"}),e("span",{className:"text-primary ml-2",children:t.start_date})]}),e("button",{type:"button",onClick:()=>O(t),className:"p-1 text-red-500 hover:text-red dark:hover:text-red-400 transition-colors",children:e(I,{className:"w-5 h-5"})})]})]})},t.id)})})}):r("div",{className:"flex flex-col justify-center items-center sm:min-h-[300px] min-h-[400px] font-semibold text-lg h-full",children:[e(S,{className:"w-16 h-16 text-gray-400 mb-4"}),e("div",{children:"No Request found"}),e("div",{className:"text-sm text-gray-500 mt-2",children:"Try changing your filters"})]}),e(w,{appear:!0,show:C,as:l.Fragment,children:r(q,{as:"div",open:C,onClose:()=>d(!1),className:"relative z-[51]",children:[e(w.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(w.Child,{as:l.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:r(q.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:()=>d(!1),className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",children:e(ee,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:"Delete Activity"}),r("div",{className:"p-5 text-center",children:[e("div",{className:"text-white bg-danger ring-4 ring-danger/30 p-4 rounded-full w-fit mx-auto",children:e(I,{className:"w-7 h-7 mx-auto"})}),e("div",{className:"sm:w-3/4 mx-auto mt-5",children:"Are you sure you want to delete this activity?"}),r("div",{className:"flex justify-center items-center mt-8",children:[e("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>d(!1),children:"Cancel"}),e("button",{type:"button",className:"btn btn-primary ltr:ml-4 rtl:mr-4",onClick:Y,children:"Delete"})]})]})]})})})})]})})]})]}),g&&e(se,{request:g,isOpen:L,onClose:()=>p(!1),onSubmit:W,modalType:"activities",title:"Process Activity Request",descriptionField:"description",requireDateRange:!0})]})};export{we as default};
