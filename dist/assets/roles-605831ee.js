import{Y as l,u as z,r as s,s as F,Z as d,S as x,j as t,a as u}from"./index-cc9649b1.js";import{I as Q}from"./IconPencil-d54c9cb1.js";import{I as U}from"./IconTrashLines-fd6636c2.js";import{T as H}from"./Table-48d24133.js";import"./index-f1655b9c.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./extends-4c19d496.js";const m={listApi:`${l()}/users/get_user_role`,createApi:`${l()}/users/create_role`,destoryApi:`${l()}/users/delete_role`,updateApi:`${l()}/users/create_role`},O=()=>{const C=z();s.useState([{value:"1",name:"Active"},{value:"0",name:"Inactive"}]);const[p,h]=s.useState(1),[f,P]=s.useState(10),[R,T]=s.useState(0),[c,$]=s.useState({columnAccessor:"id",direction:"asc"}),[g,_]=s.useState(""),[B,E]=s.useState([]),[o,w]=s.useState({id:"",name:""});s.useEffect(()=>{C(F("Create Role")),S()},[p,f,c,g]);const S=async()=>{var e;try{const n={page:p,per_page:f,sort_field:c.columnAccessor,sort_order:c.direction,search:g},a=await d.get(m.listApi,{params:n});a.data&&(E(a.data.data||[]),T(a.data.total||0))}catch(n){((e=n.response)==null?void 0:e.status)===403&&(window.location.href="/error"),y("Something wrong on server")}},[b,v]=s.useState({}),k=e=>{w({...o,[e.target.name]:e.target.value})},D=async e=>{var a,i,A;e.preventDefault();const n=!!o.id;try{let r;n?r=await d.post(`${m.updateApi}/${o.id}`,o):r=await d.post(m.createApi,o),(r.status===200||r.status===201)&&(N(r.data.message),w({id:"",name:""}),S(),v({}))}catch(r){((a=r.response)==null?void 0:a.status)===422?v(r.response.data.errors):y(((A=(i=r.response)==null?void 0:i.data)==null?void 0:A.message)||"An error occurred")}},N=e=>{x.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:e,icon:"success"})},y=e=>{x.fire({text:e,icon:"error",title:"Server Error"})},I=e=>{w({id:e.id,name:e.name})},j=async e=>{var a;if((await x.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{(await d.delete(`${m.destoryApi}/${e}`)).status===200&&(N("Role deleted successfully"),S())}catch(i){((a=i.response)==null?void 0:a.status)===403&&(window.location.href="/error"),y("Something wrong on server")}},L=e=>{_(e.target.value),h(1)},Y=[{accessor:"id",title:"#",sortable:!0,width:80,key:"id"},{accessor:"name",title:"Name",sortable:!0,key:"name"},{accessor:"actions",title:"Actions",width:120,key:"actions",render:e=>u("div",{className:"flex space-x-2",children:[t("button",{type:"button",onClick:()=>I(e),className:"btn px-1 py-0.5 rounded text-white bg-info",children:t(Q,{})}),t("button",{type:"button",onClick:()=>j(e.id),className:"btn px-1 py-0.5 rounded text-white bg-red-600",children:t(U,{})})]},`actions-${e.id}`)}];return t("form",{onSubmit:D,className:"space-y-5",children:u("div",{className:"flex flex-wrap -mx-4",children:[t("div",{className:"w-full lg:w-1/3 px-4",children:t("div",{className:"panel",children:u("div",{className:"panel-body",children:[u("div",{className:"form-group",children:[t("label",{htmlFor:"name",children:"Name"}),t("input",{name:"name",type:"text",placeholder:"Name",className:"form-input",value:o.name,onChange:k}),b.name&&t("span",{className:"text-red-500 text-sm",children:b.name[0]})]}),t("div",{className:"sm:col-span-2 flex justify-end mt-3",children:t("button",{type:"submit",className:"btn btn-primary w-full sm:w-auto",children:"Submit"})})]})})}),t("div",{className:"w-full lg:w-2/3 px-2 mt-6 lg:mt-0 md-mt-0",children:t("div",{className:"datatables",children:t(H,{columns:Y,rows:B,title:"List of all Roles",totalRecords:R,currentPage:p,recordsPerPage:f,onPageChange:e=>h(e),onRecordsPerPageChange:e=>{P(e),h(1)},onSortChange:$,onSearchChange:L,sortStatus:c,isLoading:!1,minHeight:200,noRecordsText:"No users found",searchValue:g})})})]})})};export{O as default};
