import{u as U,T as E,r as c,b as j,s as Y,a as p,j as a,ab as u,S as $,a2 as z}from"./index-fd330a89.js";import{T as V}from"./Table-f77f40b1.js";import{I as q}from"./IconBell-ff853338.js";import{I as G}from"./IconTrash-4e6f493a.js";import{I as H}from"./IconPlus-19f17580.js";import{S as J}from"./react-select.esm-508bfdab.js";import{L as K}from"./LeadModal-d9ec93d7.js";import{C as Q}from"./status-9783e7d5.js";import"./index-a2d4dba2.js";import"./floating-ui.dom-86c7411f.js";import"./extends-4c19d496.js";import"./objectWithoutPropertiesLoose-75170e70.js";import"./transition-13febe14.js";import"./IconSquareCheck-d42f7918.js";import"./IconStar-2e13c2a3.js";const ue=()=>{const s=U(),l=E(),[h,i]=c.useState([]),[C,d]=c.useState(!0),[x,w]=c.useState(!1),[n,P]=c.useState(""),[o,k]=c.useState(""),[t,v]=c.useState({columnAccessor:"lead_id",direction:"desc"}),{leads:y,loading:T,total:A,current_page:g,per_page:f}=j(e=>e.leadslices);c.useEffect(()=>{s(Y("RoadShow Leads")),(()=>{s(u({page:o?1:g,perPage:f,sortField:t.columnAccessor==="date"?"updated_at":t.columnAccessor,sortOrder:t.direction,search:o,cityname:n}))})()},[s,g,f,t,o,n]);const L=()=>{w(!0)},N=e=>{P((e==null?void 0:e.value)||""),i([]),d(!0)},_=(e,r)=>{r?(i(m=>[...m,e]),d(!1)):(i(m=>m.filter(b=>b.id!==e.id)),h.length===1&&d(!0))},D=async()=>{if(h.length===0){l.error("Please select at least one lead to remove");return}if((await $.fire({title:"Are you sure?",text:`You are about to remove ${h.length} selected lead(s). This action cannot be undone.`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Yes, delete it!",cancelButtonText:"Cancel"})).isConfirmed)try{const r=h.map(S=>S.id),m=new FormData;r.forEach(S=>m.append("lead_id[]",S));const b=await s(z({formData:m}));b.payload.status===200||b.payload.status===201?(l.success("Lead removed successfully"),i([]),d(!0),s(u({page:g,perPage:f,sortField:t.columnAccessor,sortOrder:t.direction,search:o,cityname:n}))):l.error("Failed to remove leads. Please try again.")}catch{l.error("An error occurred while removing leads.")}},R=e=>{s(u({page:e,sortField:t.columnAccessor,sortOrder:t.direction,search:o,cityname:n})),i([]),d(!0)},F=e=>{s(u({perPage:e,sortField:t.columnAccessor,sortOrder:t.direction,search:o,cityname:n})),i([]),d(!0)},O=e=>{v(e),s(u({page:1,sortField:e.columnAccessor,sortOrder:e.direction,search:o,cityname:n}))},I=e=>{const r=e.target.value;k(r),s(u({page:1,sortField:t.columnAccessor,sortOrder:t.direction,search:r,cityname:n}))},B=c.useMemo(()=>(Array.isArray(y)?y:[]).map(e=>({id:e.lead_id||"Unknown",title:e.lead_title||"Unknown",name:e.customer_name||"Unknown",phone:e.customer_phone||"Unknown",email:e.customer_email||"Unknown",date:e.created_at?new Date(e.created_at).toLocaleString():"Unknown"})),[y]),M=[{accessor:"id",title:"Select",sortable:!1,render:e=>a("input",{type:"checkbox",className:"form-checkbox",checked:h.some(r=>r.id===e.id),onChange:r=>_(e,r.target.checked)})},{accessor:"title",title:"Title",sortable:!0},{accessor:"name",title:"Name",sortable:!0},{accessor:"phone",title:"Phone",sortable:!0},{accessor:"email",title:"Email",sortable:!0,render:e=>a("span",{className:"badge bg-secondary cursor-pointer",onClick:()=>{navigator.clipboard.writeText(e.email).then(()=>l.success("Email copied to clipboard!")).catch(()=>l.error("Failed to copy email"))},children:e.email})},{accessor:"date",title:"Date",sortable:!0}];return p("div",{children:[p("div",{className:"panel flex items-center justify-between overflow-visible whitespace-nowrap p-3 text-dark relative",children:[p("div",{className:"flex items-center",children:[a("div",{className:"rounded-full bg-primary p-1.5 text-white ring-2 ring-primary/30 ltr:mr-3 rtl:ml-3",children:a(q,{})}),a("span",{className:"ltr:mr-3 rtl:ml-3",children:"Details of Your RoadShow Leads: "}),p("button",{onClick:L,className:"btn btn-success btn-sm",children:[a(H,{})," Add Lead"]})]}),p("div",{className:"flex items-center space-x-2",children:[a(J,{placeholder:"Choose City..",options:Q.map(e=>({value:e.value,label:e.name})),onChange:N,className:"cursor-pointer custom-multiselect z-10 w-[300px]",isClearable:!0}),a("button",{onClick:D,type:"button",className:"btn btn-default btn-sm",style:{background:"#d33",color:"#fff"},disabled:C,children:a(G,{})})]})]}),a("div",{className:"datatables mt-6",children:a(V,{title:"RoadShow Leads",columns:M,rows:B,totalRecords:A||0,currentPage:g,recordsPerPage:f,onPageChange:R,onRecordsPerPageChange:F,onSortChange:O,sortStatus:t,isLoading:T,onSearchChange:I,searchValue:o,noRecordsText:"No records found matching your search criteria"})}),a(K,{isOpen:x,onClose:()=>w(!1)})]})};export{ue as default};
