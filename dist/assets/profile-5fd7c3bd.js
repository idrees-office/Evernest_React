import{j as e,F as R,a as s,X as C,b as H,r as i,u as V,c as Z,T as z,Y as y,s as B,L as W}from"./index-7d85d366.js";import{I as q}from"./IconPhone-b55795d7.js";import{l as G}from"./lodash-1bb911d2.js";const J=({className:r,fill:p=!1,duotone:m=!0})=>e(R,{children:p?s("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:r,children:[e("path",{opacity:m?"0.5":"1",d:"M13.1061 22H10.8939C7.44737 22 5.72409 22 4.54903 20.9882C3.37396 19.9764 3.13025 18.2827 2.64284 14.8952L2.36407 12.9579C1.98463 10.3208 1.79491 9.00229 2.33537 7.87495C2.87583 6.7476 4.02619 6.06234 6.32691 4.69181L7.71175 3.86687C9.80104 2.62229 10.8457 2 12 2C13.1543 2 14.199 2.62229 16.2882 3.86687L17.6731 4.69181C19.9738 6.06234 21.1242 6.7476 21.6646 7.87495C22.2051 9.00229 22.0154 10.3208 21.6359 12.9579L21.3572 14.8952C20.8697 18.2827 20.626 19.9764 19.451 20.9882C18.2759 22 16.5526 22 13.1061 22Z",fill:"currentColor"}),e("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12 18.75C11.5858 18.75 11.25 18.4142 11.25 18V15C11.25 14.5858 11.5858 14.25 12 14.25C12.4142 14.25 12.75 14.5858 12.75 15V18C12.75 18.4142 12.4142 18.75 12 18.75Z",fill:"currentColor"})]}):s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:r,children:[e("path",{opacity:m?"0.5":"1",d:"M2 12.2039C2 9.91549 2 8.77128 2.5192 7.82274C3.0384 6.87421 3.98695 6.28551 5.88403 5.10813L7.88403 3.86687C9.88939 2.62229 10.8921 2 12 2C13.1079 2 14.1106 2.62229 16.116 3.86687L18.116 5.10812C20.0131 6.28551 20.9616 6.87421 21.4808 7.82274C22 8.77128 22 9.91549 22 12.2039V13.725C22 17.6258 22 19.5763 20.8284 20.7881C19.6569 22 17.7712 22 14 22H10C6.22876 22 4.34315 22 3.17157 20.7881C2 19.5763 2 17.6258 2 13.725V12.2039Z",stroke:"currentColor",strokeWidth:"1.5"}),e("path",{d:"M12 15L12 18",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]})}),w={updateApi:`${C()}/users/update_user`,updateApi2:`${C()}/users/update_status`,agentApi:`${C()}/users/user_list?for_select=1`},K=()=>{const r=H(t=>t.auth.user||{}),p=i.useRef({profile:null}),m=V(),P=Z(),f=z(),[c,k]=i.useState({}),[A,S]=i.useState([]),F=i.useRef(!1),[h,D]=i.useState(null),[v,x]=i.useState(null);i.useEffect(()=>{const t=G.debounce(async()=>{try{const a=await y.get(w.agentApi);S(a.data)}catch{f.error("Failed to fetch agents")}},500);F.current||(m(B("Account Setting")),t(),F.current=!0)},[m]);const[b,T]=i.useState("home"),[o,I]=i.useState({client_user_name:(r==null?void 0:r.client_user_name)||"",client_user_id:(r==null?void 0:r.client_user_id)||"",client_user_designation:(r==null?void 0:r.client_user_designation)||"",client_user_email:(r==null?void 0:r.client_user_email)||"",client_user_phone:(r==null?void 0:r.client_user_phone)||""}),E=t=>{T(t)},g=t=>{const{name:a,value:n}=t.target;I(l=>({...l,[a]:n}))},$=t=>{const a=A.find(n=>n.client_user_id===Number(t));a?(D(Number(t)),x(a.client_user_status)):(D(null),x(null))},j=async t=>{var a,n,l;t.preventDefault();try{if(p.current.profile){const d=new FormData(p.current.profile),_=d.get("client_user_id"),N=await y.post(w.updateApi+"/"+_,d);if(N.status===200||N.status===201){const u=N.data.user;u&&(m({type:"auth/updateUser",payload:u}),localStorage.setItem("authUser",JSON.stringify(u)),I({client_user_name:u.client_user_name||"",client_user_id:u.client_user_id||"",client_user_designation:u.client_user_designation||"",client_user_email:u.client_user_email||"",client_user_phone:u.client_user_phone||""})),P("/"),k({}),f.success("Profile updated successfully")}}}catch(d){(n=(a=d.response)==null?void 0:a.data)!=null&&n.errors?k(d.response.data.errors):((l=d.response)==null?void 0:l.status)===403&&(window.location.href="/error")}},M=async t=>{if(!h)return;const n=t.target.checked?0:1;try{const l=await y.post(w.updateApi2,{selectedAgentId:h,client_user_status:n});(l.status===200||l.status===201)&&(f.success(l.data.message),x(n),S(d=>d.map(_=>_.client_user_id===h?{..._,client_user_status:n}:_)))}catch(l){console.error("Error updating status:",l),f.error("Failed to update user status")}};return s("div",{children:[s("ul",{className:"flex space-x-2 rtl:space-x-reverse",children:[e("li",{children:e(W,{to:"#",className:"text-primary hover:underline",children:" Users "})}),e("li",{className:"before:content-['/'] ltr:before:mr-2 rtl:before:ml-2",children:e("span",{children:"Account Settings"})})]}),s("div",{className:"pt-5",children:[e("div",{children:s("ul",{className:"sm:flex font-semibold border-b border-[#ebedf2] dark:border-[#191e3a] mb-5 whitespace-nowrap overflow-y-auto",children:[e("li",{className:"inline-block",children:s("button",{onClick:()=>E("home"),className:`flex gap-2 p-4 border-b border-transparent hover:border-primary hover:text-primary ${b==="home"?"!border-primary text-primary":""}`,children:[e(J,{}),"Home"]})}),e("li",{className:"inline-block",children:s("button",{onClick:()=>E("danger-zone"),className:`flex gap-2 p-4 border-b border-transparent hover:border-primary hover:text-primary ${b==="danger-zone"?"!border-primary text-primary":""}`,children:[e(q,{}),"Danger Zone"]})})]})}),b==="home"?e("div",{children:s("form",{ref:t=>p.current.profile=t,onSubmit:j,className:"border border-[#ebedf2] dark:border-[#191e3a] rounded-md p-4 mb-5 bg-white dark:bg-black",children:[e("h6",{className:"text-lg font-bold mb-5",children:"General Information"}),s("div",{className:"flex flex-col sm:flex-row",children:[e("div",{className:"ltr:sm:mr-4 rtl:sm:ml-4 w-full sm:w-2/12 mb-5",children:e("img",{src:"https://oldweb.brur.ac.bd/wp-content/uploads/2019/03/male.jpg",alt:"img",className:"w-20 h-20 md:w-32 md:h-32 rounded-full object-cover mx-auto"})}),s("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 gap-5",children:[s("div",{children:[e("label",{htmlFor:"name",children:"Full Name"}),e("input",{id:"name",name:"client_user_name",type:"text",placeholder:"Name",className:"form-input",value:o.client_user_name,onChange:g}),e("input",{id:"name",name:"client_user_id",type:"hidden",className:"form-input",value:r==null?void 0:r.client_user_id}),c.client_user_name&&e("span",{className:"text-red-500 text-sm",children:c.client_user_name})]}),s("div",{children:[e("label",{htmlFor:"profession",children:"Designation"}),e("input",{id:"profession",name:"client_user_designation",type:"text",placeholder:"Web Developer",className:"form-input",value:o.client_user_designation,onChange:g}),c.client_user_designation&&e("span",{className:"text-red-500 text-sm",children:c.client_user_designation})]}),s("div",{children:[e("label",{htmlFor:"profession",children:"Email"}),e("input",{id:"profession",name:"client_user_email",type:"text",placeholder:"Email",className:"form-input",value:o==null?void 0:o.client_user_email,onChange:g}),c.client_user_email&&e("span",{className:"text-red-500 text-sm",children:c.client_user_email})]}),s("div",{children:[e("label",{htmlFor:"profession",children:"Phone"}),e("input",{id:"profession",type:"text",name:"client_user_phone",placeholder:"Phone",className:"form-input",value:o==null?void 0:o.client_user_phone,onChange:g}),c.client_user_phone&&e("span",{className:"text-red-500 text-sm",children:c.client_user_phone})]}),e("div",{className:"sm:col-span-2 mt-3",children:e("button",{type:"submit",className:"btn btn-success",children:" Save "})})]})]})]})}):"",b==="danger-zone"?e("div",{className:"",children:e("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:s("div",{className:"panel space-y-5",children:[e("h5",{className:"font-semibold text-lg mb-4",children:"Deactivate Account"}),e("p",{children:"The agent is no longer part of the team."}),s("select",{className:"mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md",value:h??"",onChange:t=>$(t.target.value),children:[e("option",{value:"",children:"Select Agent"}),A.map(t=>e("option",{value:t.client_user_id,children:t.client_user_name},t.client_user_id))]}),h&&e("div",{className:"flex items-center mt-4",children:s("label",{className:"inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",className:"sr-only peer",checked:v===0,onChange:M}),e("div",{className:`relative w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer 
                                                ${v===0?"bg-green-500":"bg-red-500"} 
                                                peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] 
                                                after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border 
                                                after:rounded-full after:h-5 after:w-5 after:transition-all`}),e("span",{className:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:v===0?"Deactivated":"Active"})]})})]})})}):""]})]})};export{K as default};
