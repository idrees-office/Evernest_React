import{Y as x,u as Y,r,Z as d,S as y,j as t,a as i}from"./index-55aa5a2e.js";import{I as H}from"./IconTrashLines-18dbdd06.js";import{I as Q}from"./IconPencil-c19be528.js";import{T as V}from"./Table-87bfdcc2.js";/* empty css                  */import"./index-937b3efd.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./extends-4c19d496.js";const u={createApi:`${x()}/announcements/store`,listApi:`${x()}/announcements/show`,destoryApi:`${x()}/announcements/delete`},X=()=>{Y();const c=r.useRef({userformRef:null}),[R,C]=r.useState([]),[b,v]=r.useState({});r.useState(null);const[U,P]=r.useState(null);r.useRef(!1);const[m,p]=r.useState(1),[f,T]=r.useState(10),[_,$]=r.useState(0),[l,B]=r.useState({columnAccessor:"client_user_id",direction:"asc"}),[h,D]=r.useState("");r.useEffect(()=>{g()},[m,f,l,h]);const g=async()=>{var e;try{const s={page:m,per_page:f,sort_field:l.columnAccessor,sort_order:l.direction,search:h},n=await d.get(u.listApi,{params:s});n.data&&(C(n.data.data.data||[]),$(n.data.data.total||0))}catch(s){((e=s.response)==null?void 0:e.status)===403&&(window.location.href="/error"),w()}},E=async e=>{var s,n,o;e.preventDefault();try{if(c.current.userformRef){const a=new FormData(c.current.userformRef),A=a.get("announcements_id"),S=A?await d.post(`${u.createApi}/${A}`,a):await d.post(u.createApi,a);(S.status===200||S.status===201)&&(N(S.data.message),g(),v({}),c.current.userformRef.reset(),P(null))}}catch(a){console.log(a),(n=(s=a.response)==null?void 0:s.data)!=null&&n.errors?v(a.response.data.errors):((o=a.response)==null?void 0:o.status)===403||w()}},N=e=>{y.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:e,icon:"success"})},w=()=>{y.fire({text:"Something went wrong on the server",icon:"error",title:"Server Error"})},k=async e=>{if(c.current.userformRef){const s=c.current.userformRef;s.reset(),s.announcements_id.value=e.id||"",s.title.value=e.title||"",s.description.value=e.description||""}},I=async e=>{var n;if((await y.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const o=await d.delete(u.destoryApi+`/${e.id}`);(o.status===200||o.status===201)&&(N("Announcements deleted successfully"),g())}catch(o){((n=o.response)==null?void 0:n.status)===403&&(window.location.href="/error"),w()}},j=e=>{D(e.target.value),p(1)},L=e=>{p(e)},z=e=>{T(e),p(1)},F=[{accessor:"id",title:"#",width:80,key:"id"},{accessor:"title",title:"Title",sortable:!0,key:"title"},{accessor:"actions",title:"Actions",width:120,key:"actions-column",render:e=>i("div",{className:"flex space-x-2",children:[t("button",{type:"button",onClick:()=>k(e),className:"btn px-1 py-0.5 rounded text-white bg-info",children:t(Q,{})},`edit-${e.id}`),t("button",{type:"button",onClick:()=>I(e),className:"btn px-1 py-0.5 rounded text-white bg-red-600",children:t(H,{})},`delete-${e.id}`)]})}];return t("form",{ref:e=>c.current.userformRef=e,onSubmit:E,className:"space-y-5",children:i("div",{className:"flex flex-wrap -mx-4",children:[t("div",{className:"w-full lg:w-1/3 px-4",children:t("div",{className:"panel",children:t("div",{className:"panel-body",children:i("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i("div",{className:"form-group sm:col-span-2",children:[t("label",{htmlFor:"title",children:"Announcements Title"}),t("input",{name:"title",type:"text",placeholder:"Title",className:"form-input"}),t("input",{type:"text",name:"announcements_id",id:"announcements_id"}),b.title&&t("span",{className:"text-red-500 text-sm",children:b.title})]}),i("div",{className:"form-group sm:col-span-2",children:[t("label",{htmlFor:"description",children:"Announcements Description"}),t("textarea",{name:"description",id:"description",className:"form-input",style:{height:"316px"},defaultValue:"Hi, "})]}),t("div",{className:"sm:col-span-2 flex justify-end",children:t("button",{type:"submit",className:"btn btn-success w-full",children:" Submit "})})]})})})}),t("div",{className:"w-full lg:w-2/3 px-2 mt-6 lg:mt-0 md-mt-0",children:t("div",{className:"datatables",children:t(V,{columns:F,rows:R,title:"List of all Announcements",idAccessor:"id",totalRecords:_,currentPage:m,recordsPerPage:f,onPageChange:L,onRecordsPerPageChange:z,onSortChange:B,onSearchChange:j,sortStatus:l,isLoading:!1,minHeight:200,noRecordsText:"No users found",searchValue:h})})})]})})};export{X as default};
