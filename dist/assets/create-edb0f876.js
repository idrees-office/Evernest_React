import{X as w,u as W,r as a,s as Z,Y as u,S as _,b as t,j as r}from"./index-925e5e72.js";import{o as F,L as O}from"./status-75ec65ea.js";import{S as C}from"./react-select.esm-7acf1afd.js";import{I as ee}from"./IconTrashLines-ea7fbf56.js";import{I as te}from"./IconPencil-ca78e4f4.js";import{T as re}from"./Table-4c615204.js";/* empty css                  */import{I as $}from"./Icon-f1a550ea.js";import"./IconSquareCheck-9b2302aa.js";import"./IconStar-1841438a.js";import"./IconTrash-e779921f.js";import"./objectWithoutPropertiesLoose-f3b3ace0.js";import"./extends-4c19d496.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./index-2d506cb4.js";import"./IconBell-b7a79d6e.js";import"./IconClock-0ea71a34.js";import"./IconLink-fbede3cf.js";import"./IconNotesEdit-8107e41d.js";import"./IconHome-8132fd16.js";import"./IconMail-849d355b.js";import"./IconPlus-e9fc40e8.js";import"./IconTwitter-a05dd1cc.js";import"./IconGoogle-d01ca91e.js";import"./IconHorizontalDots-e3d20239.js";import"./IconLockDots-cd602d1c.js";const m={createApi:`${w()}/statuses/create`,listApi:`${w()}/statuses/show`,destoryApi:`${w()}/statuses/delete`},Te=()=>{const R=W(),c=a.useRef({userformRef:null}),[E,L]=a.useState([]),[k,p]=a.useState(null),[s,I]=a.useState({});a.useState(null);const[se,B]=a.useState(null),A=a.useRef(!1),[h,f]=a.useState(1),[g,D]=a.useState(10),[U,j]=a.useState(0),[d,q]=a.useState({columnAccessor:"id",direction:"asc"}),[S,z]=a.useState(""),[Y,x]=a.useState(null),[Q,N]=a.useState(null);a.useEffect(()=>{A.current||(R(Z("Create User")),A.current=!0)},[R]),a.useEffect(()=>{b()},[h,g,d,S]);const b=async()=>{var e;try{const o={page:h,per_page:g,sort_field:d.columnAccessor,sort_order:d.direction,search:S},l=await u.get(m.listApi,{params:o});l.data&&(L(l.data.data||[]),j(l.data.total||0))}catch(o){((e=o.response)==null?void 0:e.status)===403&&(window.location.href="/error"),y()}},H=async e=>{var o,l,n;e.preventDefault();try{if(c.current.userformRef){const i=new FormData(c.current.userformRef),T=i.get("id"),v=T?await u.post(`${m.createApi}/${T}`,i):await u.post(m.createApi,i);(v.status===200||v.status===201)&&(P(v.data.message),b(),I({}),c.current.userformRef.reset(),B(null),p(null),x(null),N(null))}}catch(i){(l=(o=i.response)==null?void 0:o.data)!=null&&l.errors?I(i.response.data.errors):((n=i.response)==null?void 0:n.status)===403||y()}},P=e=>{_.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:e,icon:"success"})},y=()=>{_.fire({text:"Something went wrong on the server",icon:"error",title:"Server Error"})},M=async e=>{if(c.current.userformRef){const o=c.current.userformRef;o.id.value=e.id||"",o.name.value=e.name||"",o.type.value=e.type||"",o.status_old_id.value=e.status_old_id||"",o.sort_order.value=e.sort_order||"",o.color.value=e.color||"",p(e.status||""),x(e.status_for||""),N(e.icon!==null?Number(e.icon):null),setTimeout(()=>{const l=o.querySelector('input[type="color"]');l&&l.click()},100)}},V=async e=>{var l;if((await _.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const n=await u.delete(m.destoryApi+`/${e.id}`);(n.status===200||n.status===201)&&(P("User deleted successfully"),b())}catch(n){((l=n.response)==null?void 0:l.status)===403&&(window.location.href="/error"),y()}},X=e=>{z(e.target.value),f(1)},G=e=>{f(e)},J=e=>{D(e),f(1)},K=[{accessor:"id",title:"#",width:80,key:"id"},{accessor:"name",title:"Name",sortable:!0},{accessor:"color",title:"Color",sortable:!0,render:e=>r("div",{className:"flex items-center space-x-2",children:[t("div",{className:"w-5 h-5 rounded-full border",style:{backgroundColor:e.color}}),t("span",{children:e.color})]})},{accessor:"type",title:"Type",width:120,render:e=>t("div",{className:"flex space-x-2",children:r("span",{className:"badge bg-info",children:[" ",e.type," "]})})},{accessor:"status_old_id",title:"Old Id",width:120,render:e=>t("div",{className:"flex space-x-2",children:r("span",{className:"badge bg-success",children:[" ",e.status_old_id," "]})})},{accessor:"actions",title:"Actions",width:120,key:"actions-column",render:e=>r("div",{className:"flex space-x-2",children:[t("button",{type:"button",onClick:()=>M(e),className:"btn px-1 py-0.5 rounded text-white bg-info",children:t(te,{})},`edit-${e.client_user_id}`),t("button",{type:"button",onClick:()=>V(e),className:"btn px-1 py-0.5 rounded text-white bg-red-600",children:t(ee,{})},`delete-${e.client_user_id}`)]})}];return t("form",{ref:e=>c.current.userformRef=e,onSubmit:H,className:"space-y-5",children:r("div",{className:"flex flex-wrap -mx-4",children:[t("div",{className:"w-full lg:w-1/3 px-4",children:t("div",{className:"panel",children:t("div",{className:"panel-body",children:r("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[r("div",{className:"form-group",children:[t("label",{htmlFor:"name",children:"Stage Name"}),t("input",{name:"name",type:"text",placeholder:"Name",className:"form-input"}),t("input",{type:"hidden",name:"id",id:"id"}),s.name&&r("span",{className:"text-red-500 text-sm",children:[" ",s.name," "]})]}),r("div",{className:"form-group",children:[t("label",{htmlFor:"color",children:"Stage Color"}),t("input",{name:"color",type:"color",required:!0,placeholder:"Color",className:"form-input",style:{height:"37px"}}),s.color&&r("span",{className:"text-red-500 text-sm",children:[" ",s.color," "]})]}),r("div",{className:"form-group",children:[t("label",{htmlFor:"type",children:"Stage Type"}),t("input",{name:"type",type:"text",placeholder:"sidebar | top-bar means dashboard",className:"form-input"}),s.type&&r("span",{className:"text-red-500 text-sm",children:[" ",s.type," "]})]}),r("div",{className:"form-group",children:[t("label",{htmlFor:"status",children:"Stage Status"}),t(C,{name:"status",placeholder:"Select an option",options:F,value:F.find(e=>e.value===k),onChange:e=>p((e==null?void 0:e.value)||null)}),s.status&&r("span",{className:"text-red-500 text-sm",children:[" ",s.status," "]})]}),r("div",{className:"form-group",children:[t("label",{htmlFor:"status_for",children:"Stage For"}),t(C,{name:"status_for",placeholder:"Select an option",options:O,value:O.find(e=>e.value===Y),onChange:e=>x((e==null?void 0:e.value)||null)}),s.status_for&&r("span",{className:"text-red-500 text-sm",children:[" ",s.status_for," "]})]}),r("div",{className:"form-group",children:[t("label",{htmlFor:"sort_order",children:"Sort Order"}),t("input",{name:"sort_order",type:"number",placeholder:"Sort Order",className:"form-input"}),s.sort_order&&r("span",{className:"text-red-500 text-sm",children:[" ",s.sort_order," "]})]}),r("div",{className:"form-group",children:[t("label",{htmlFor:"status_old_id",children:"Stage Old Id"}),t("input",{name:"status_old_id",type:"number",placeholder:"Status Old Id",className:"form-input w-full"}),s.status_old_id&&r("span",{className:"text-red-500 text-sm",children:[" ",s.status_old_id," "]})]}),r("div",{className:"form-group",children:[t("label",{htmlFor:"icon",children:"Icon"}),t(C,{name:"icon",placeholder:"Select an option",options:$,value:$.find(e=>e.value===Q),onChange:e=>N((e==null?void 0:e.value)??null),formatOptionLabel:e=>r("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[" ",e.label," ",t("span",{children:e.iconName})," "]})}),s.icon&&r("span",{className:"text-red-500 text-sm",children:[" ",s.icon," "]})]}),t("div",{className:"sm:col-span-2",children:t("button",{type:"submit",className:"btn btn-primary w-full",children:"Submit"})})]})})})}),t("div",{className:"w-full lg:w-2/3 px-2 mt-6 lg:mt-0 md-mt-0",children:t("div",{className:"datatables",children:t(re,{columns:K,rows:E,title:"All Leads Stages",idAccessor:"id",totalRecords:U,currentPage:h,recordsPerPage:g,onPageChange:G,onRecordsPerPageChange:J,onSortChange:q,onSearchChange:X,sortStatus:d,isLoading:!1,minHeight:200,noRecordsText:"No Stage found",searchValue:S})})})]})})};export{Te as default};
