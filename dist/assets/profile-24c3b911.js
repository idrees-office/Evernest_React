import{g as y,a as R,r as i,u as H,c as q,T as B,h as w,s as G,j as s,b as e,L as J}from"./index-73019b34.js";import{a as M,I as O}from"./IconHome-c3ba87ed.js";import{l as W}from"./lodash-b719a5ca.js";const k={updateApi:`${y()}/users/update_user`,updateApi2:`${y()}/users/update_status`,agentApi:`${y()}/users/user_list?for_select=1`},V=()=>{const r=R(t=>t.auth.user||{}),b=i.useRef({profile:null}),g=H(),P=q(),h=B(),[c,A]=i.useState({}),[S,C]=i.useState([]),F=i.useRef(!1),[m,D]=i.useState(null),[x,v]=i.useState(null);i.useEffect(()=>{const t=W.debounce(async()=>{try{const a=await w.get(k.agentApi);C(a.data)}catch{h.error("Failed to fetch agents")}},500);F.current||(g(G("Account Setting")),t(),F.current=!0)},[g]);const[_,T]=i.useState("home"),[o,I]=i.useState({client_user_name:(r==null?void 0:r.client_user_name)||"",client_user_id:(r==null?void 0:r.client_user_id)||"",client_user_designation:(r==null?void 0:r.client_user_designation)||"",client_user_email:(r==null?void 0:r.client_user_email)||"",client_user_phone:(r==null?void 0:r.client_user_phone)||""}),E=t=>{T(t)},f=t=>{const{name:a,value:n}=t.target;I(l=>({...l,[a]:n}))},$=t=>{const a=S.find(n=>n.client_user_id===Number(t));a?(D(Number(t)),v(a.client_user_status)):(D(null),v(null))},j=async t=>{var a,n,l;t.preventDefault();try{if(b.current.profile){const d=new FormData(b.current.profile),p=d.get("client_user_id"),N=await w.post(k.updateApi+"/"+p,d);if(N.status===200||N.status===201){const u=N.data.user;u&&(g({type:"auth/updateUser",payload:u}),localStorage.setItem("authUser",JSON.stringify(u)),I({client_user_name:u.client_user_name||"",client_user_id:u.client_user_id||"",client_user_designation:u.client_user_designation||"",client_user_email:u.client_user_email||"",client_user_phone:u.client_user_phone||""})),P("/"),A({}),h.success("Profile updated successfully")}}}catch(d){(n=(a=d.response)==null?void 0:a.data)!=null&&n.errors?A(d.response.data.errors):((l=d.response)==null?void 0:l.status)===403&&(window.location.href="/error")}},z=async t=>{if(!m)return;const n=t.target.checked?0:1;try{const l=await w.post(k.updateApi2,{selectedAgentId:m,client_user_status:n});(l.status===200||l.status===201)&&(h.success(l.data.message),v(n),C(d=>d.map(p=>p.client_user_id===m?{...p,client_user_status:n}:p)))}catch(l){console.error("Error updating status:",l),h.error("Failed to update user status")}};return s("div",{children:[s("ul",{className:"flex space-x-2 rtl:space-x-reverse",children:[e("li",{children:e(J,{to:"#",className:"text-primary hover:underline",children:" Users "})}),e("li",{className:"before:content-['/'] ltr:before:mr-2 rtl:before:ml-2",children:e("span",{children:"Account Settings"})})]}),s("div",{className:"pt-5",children:[e("div",{children:s("ul",{className:"sm:flex font-semibold border-b border-[#ebedf2] dark:border-[#191e3a] mb-5 whitespace-nowrap overflow-y-auto",children:[e("li",{className:"inline-block",children:s("button",{onClick:()=>E("home"),className:`flex gap-2 p-4 border-b border-transparent hover:border-primary hover:text-primary ${_==="home"?"!border-primary text-primary":""}`,children:[e(M,{}),"Home"]})}),e("li",{className:"inline-block",children:s("button",{onClick:()=>E("danger-zone"),className:`flex gap-2 p-4 border-b border-transparent hover:border-primary hover:text-primary ${_==="danger-zone"?"!border-primary text-primary":""}`,children:[e(O,{}),"Danger Zone"]})})]})}),_==="home"?e("div",{children:s("form",{ref:t=>b.current.profile=t,onSubmit:j,className:"border border-[#ebedf2] dark:border-[#191e3a] rounded-md p-4 mb-5 bg-white dark:bg-black",children:[e("h6",{className:"text-lg font-bold mb-5",children:"General Information"}),s("div",{className:"flex flex-col sm:flex-row",children:[e("div",{className:"ltr:sm:mr-4 rtl:sm:ml-4 w-full sm:w-2/12 mb-5",children:e("img",{src:"https://oldweb.brur.ac.bd/wp-content/uploads/2019/03/male.jpg",alt:"img",className:"w-20 h-20 md:w-32 md:h-32 rounded-full object-cover mx-auto"})}),s("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 gap-5",children:[s("div",{children:[e("label",{htmlFor:"name",children:"Full Name"}),e("input",{id:"name",name:"client_user_name",type:"text",placeholder:"Name",className:"form-input",value:o.client_user_name,onChange:f}),e("input",{id:"name",name:"client_user_id",type:"hidden",className:"form-input",value:r==null?void 0:r.client_user_id}),c.client_user_name&&e("span",{className:"text-red-500 text-sm",children:c.client_user_name})]}),s("div",{children:[e("label",{htmlFor:"profession",children:"Designation"}),e("input",{id:"profession",name:"client_user_designation",type:"text",placeholder:"Web Developer",className:"form-input",value:o.client_user_designation,onChange:f}),c.client_user_designation&&e("span",{className:"text-red-500 text-sm",children:c.client_user_designation})]}),s("div",{children:[e("label",{htmlFor:"profession",children:"Email"}),e("input",{id:"profession",name:"client_user_email",type:"text",placeholder:"Email",className:"form-input",value:o==null?void 0:o.client_user_email,onChange:f}),c.client_user_email&&e("span",{className:"text-red-500 text-sm",children:c.client_user_email})]}),s("div",{children:[e("label",{htmlFor:"profession",children:"Phone"}),e("input",{id:"profession",type:"text",name:"client_user_phone",placeholder:"Phone",className:"form-input",value:o==null?void 0:o.client_user_phone,onChange:f}),c.client_user_phone&&e("span",{className:"text-red-500 text-sm",children:c.client_user_phone})]}),e("div",{className:"sm:col-span-2 mt-3",children:e("button",{type:"submit",className:"btn btn-success",children:" Save "})})]})]})]})}):"",_==="danger-zone"?e("div",{className:"",children:e("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:s("div",{className:"panel space-y-5",children:[e("h5",{className:"font-semibold text-lg mb-4",children:"Deactivate Account"}),e("p",{children:"The agent is no longer part of the team."}),s("select",{className:"mt-1 block w-full py-2 px-3 border border-gray-300 rounded-md",value:m??"",onChange:t=>$(t.target.value),children:[e("option",{value:"",children:"Select Agent"}),S.map(t=>e("option",{value:t.client_user_id,children:t.client_user_name},t.client_user_id))]}),m&&e("div",{className:"flex items-center mt-4",children:s("label",{className:"inline-flex items-center cursor-pointer",children:[e("input",{type:"checkbox",className:"sr-only peer",checked:x===0,onChange:z}),e("div",{className:`relative w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer 
                                                ${x===0?"bg-green-500":"bg-red-500"} 
                                                peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] 
                                                after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border 
                                                after:rounded-full after:h-5 after:w-5 after:transition-all`}),e("span",{className:"ml-3 text-sm font-medium text-gray-900 dark:text-gray-300",children:x===0?"Deactivated":"Active"})]})})]})})}):""]})]})};export{V as default};
