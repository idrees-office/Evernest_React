import{u as E,c as Y,T as B,r,b as V,s as $,a as d,j as t,a0 as i,a1 as q}from"./index-e711df91.js";import{T as G}from"./Table-b368cb67.js";import{I as H}from"./IconBell-90fa7463.js";import{I as J}from"./IconPlus-cb8f5be8.js";import{S as N}from"./react-select.esm-dc22d81a.js";import{L as K}from"./LeadModal-8a086984.js";/* empty css                  */import{D as Q}from"./status-6579bd3d.js";import{E as X}from"./jspdf.plugin.autotable-8b2de753.js";import"./index-5634db68.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./extends-4c19d496.js";import"./objectWithoutPropertiesLoose-f3b3ace0.js";import"./transition-254e6c6d.js";import"./IconThumbUp-ff0f797a.js";import"./IconTrash-8cf3f788.js";const Ne=()=>{const o=E();Y();const b=B(),S=Q(),w=r.useRef({fetched:!1,form:null,prevPage:1,prevPerPage:10,prevSortStatus:{columnAccessor:"id",direction:"desc"}}),[Z,P]=r.useState([]),[ee,y]=r.useState(!0),[_,C]=r.useState(!1),[v,x]=r.useState(null),[p,A]=r.useState(null),[n,D]=r.useState(""),[a,k]=r.useState({columnAccessor:"id",direction:"desc"}),{leads:h,loading:L,agents:g,total:T,last_page:te,current_page:u,per_page:c}=V(e=>e.leadslices);r.useEffect(()=>{o($("All Leads"));const e=()=>{o(i({page:n?1:u,perPage:c,sortField:a.columnAccessor,sortOrder:a.direction,search:n}))};if(!w.current.fetched){e(),w.current.fetched=!0;return}},[o,u,c,a,n]);const R=g==null?void 0:g.map(e=>({value:e==null?void 0:e.client_user_id,label:e==null?void 0:e.client_user_name,phone:e==null?void 0:e.client_user_phone})),F=e=>{x(e)},O=e=>{A(e.value)},U=async()=>{var m;if(!v){b.error("Please select an agent before downloading.");return}if(!p){b.error("Please select a status before downloading.");return}const e=new FormData;e.append("lead_status",p),e.append("agent_id",v.toString());const s=await o(q({formData:e}));if(s.payload.status===200||s.payload.status===201){o(i({page:u,perPage:c,sortField:a.columnAccessor,sortOrder:a.direction,search:n}));const l=new X;l.setFontSize(16),W(p),l.text(`Agent: ${s.payload.agent_name}`,10,10),l.text("Lead Status: Not Responding",180,10,{align:"right"}),l.text(" ",10,10);const j=[["Lead Title","Comment","Time"]],z=(m=s.payload.data)==null?void 0:m.map(f=>[f.lead_title,f.lead_comment,I(f.updated_at)]);l.autoTable({head:j,body:z,startY:30,columnStyles:{0:{cellWidth:"auto"},1:{cellWidth:"auto"},2:{cellWidth:"auto"}},theme:"grid",styles:{cellPadding:3,fontSize:12,fontStyle:"normal"},headStyles:{fillColor:[22,160,133],textColor:[255,255,255],fontStyle:"bold"},bodyStyles:{fillColor:[240,240,240]}}),l.save("reports.pdf")}},I=e=>new Date(e).toLocaleString(),W=e=>{const s=S.find(m=>m.value===e);return s?s.label:"Unknown Status"},M=r.useMemo(()=>(Array.isArray(h)?h:[]).map(e=>({id:e.lead_id||"Unknown",title:e.lead_title||"Unknown",name:e.customer_name||"Unknown",phone:e.customer_phone||"Unknown",source:e.lead_source||"Unknown",date:e.created_at?new Date(e.created_at).toLocaleString():"Unknown"})),[h]);return d("div",{children:[d("div",{className:"panel flex items-center justify-between overflow-visible whitespace-nowrap p-3 text-dark relative",children:[d("div",{className:"flex items-center",children:[d("div",{className:"rounded-full bg-primary p-1.5 text-white ring-2 ring-primary/30 ltr:mr-3 rtl:ml-3",children:[" ",t(H,{})," "]}),t("span",{className:"ltr:mr-3 rtl:ml-3",children:" Details of Your Agents Pdf Reports. "})]}),d("div",{className:"flex items-center space-x-2",children:[t("div",{className:"w-[300px]",children:t(N,{placeholder:"Select an option",options:R,classNamePrefix:"custom-select",className:"custom-multiselect z-10",onChange:e=>{(e==null?void 0:e.value)!==void 0&&F(e.value)}})}),t(N,{placeholder:"Move Lead....",options:S,onChange:e=>O(e),name:"lead_status",className:"cursor-pointer custom-multiselect z-10 w-[300px]"}),d("button",{onClick:()=>{U()},type:"button",className:"btn btn-secondary btn-sm",children:[t(J,{})," Download "]})]})]}),t("div",{className:"datatables mt-6",children:t(G,{title:"All Leads",columns:[{accessor:"title",title:"Title",sortable:!0},{accessor:"name",title:"Name",sortable:!0},{accessor:"phone",title:"Phone",sortable:!0},{accessor:"source",title:"Source",sortable:!0,render:e=>{switch(e.source){case"Facebook":return t("span",{className:"badge bg-info",children:"Facebook"});case"Instagram":return t("span",{className:"badge bg-secondary",children:"Instagram"});case"created own":return t("span",{className:"badge bg-success",children:"Created own"});case"Website":return t("span",{className:"badge bg-warning",children:"Website"});case"Reshuffle":return t("span",{className:"badge bg-primary",children:"Reshuffle"});case"Walk-in":return t("span",{className:"badge bg-danger",children:"Walk-in"});case"Other":return t("span",{className:"badge bg-secondary",children:"Other"});default:return t("span",{className:"badge bg-secondary",children:"Unknown"})}}},{accessor:"date",title:"Date",sortable:!0}],rows:M,totalRecords:T||0,currentPage:u,recordsPerPage:c,onPageChange:e=>{o(i({page:e,sortField:a.columnAccessor,sortOrder:a.direction,search:n})),P([]),y(!0)},onRecordsPerPageChange:e=>{o(i({perPage:e,sortField:a.columnAccessor,sortOrder:a.direction,search:n})),P([]),y(!0)},onSortChange:e=>{k(e),o(i({page:1,perPage:c,sortField:a.columnAccessor,sortOrder:a.direction,search:n}))},sortStatus:a,isLoading:L,onSearchChange:e=>{const s=e.target.value;D(s),o(i({page:1,perPage:c,sortField:a.columnAccessor,sortOrder:a.direction,search:s}))},searchValue:n,noRecordsText:"No records found matching your search criteria"})}),t(K,{isOpen:_,onClose:()=>C(!1)})]})};export{Ne as default};
