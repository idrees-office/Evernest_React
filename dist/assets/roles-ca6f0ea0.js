import{Y as l,u as U,r as i,s as _,Z as c,S as h,j as t,a as d}from"./index-ecd8b930.js";import{T as j}from"./Table-6ab4780a.js";import{I as L}from"./IconPencil-67f6aa73.js";import{I as $}from"./IconTrashLines-347fbd7d.js";import"./index-07531e55.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./extends-4c19d496.js";import"./_baseIsEqual-3b5d9dab.js";const m={listApi:`${l()}/users/get_user_role`,createApi:`${l()}/users/create_role`,destoryApi:`${l()}/users/delete_role`,updateApi:`${l()}/users/update_role`},H=()=>{const E=U();i.useState([{value:"1",name:"Active"},{value:"0",name:"Inactive"}]);const[w,T]=i.useState([]),[o,u]=i.useState({id:"",name:""});i.useEffect(()=>{E(_("Create Role")),p()},[]);const k=(Array.isArray(w)?w:[]).map((e,s)=>({id:e.id||"Unknown",name:e.name||"Unknown",role:e||"Unknown"})),p=async()=>{var e;try{const s=await c.get(m.listApi);s.data&&T(s.data)}catch(s){((e=s.response)==null?void 0:e.status)===403&&(window.location.href="/error"),f("Something wrong on server")}},[b,g]=i.useState({}),B=e=>{u({...o,[e.target.name]:e.target.value})},D=async e=>{var r,y,v,N,A,S,C;e.preventDefault();const s=!!o.id;let a;s===!0?a=await c.post(m.updateApi+"/"+o.id,o):a=await c.post(m.createApi,o);try{(a.status===200||a.status===201)&&(x(a.data.message),u({id:"",name:""}),p(),g({}))}catch(n){console.log("ddd"),console.log(n),((r=n.response)==null?void 0:r.status)===422&&console.log("Validation Errors:",(v=(y=n.response)==null?void 0:y.data)==null?void 0:v.errors),(A=(N=n.response)==null?void 0:N.data)!=null&&A.errors?g(n.response.data.errors):f(((C=(S=n.response)==null?void 0:S.data)==null?void 0:C.message)||"An error occurred")}},x=e=>{h.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:e,icon:"success"})},f=e=>{h.fire({text:e,icon:"error",title:"Server Error"})},I=async e=>{u({id:e.id,name:e.name})},R=async e=>{var a;if((await h.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const r=await c.delete(m.destoryApi+"/"+e);(r.status==200||r.status===200)&&(x("Roles deleted successfully"),p())}catch(r){((a=r.response)==null?void 0:a.status)===403&&(window.location.href="/error"),f("Something wrong on server")}};return t("form",{onSubmit:D,className:"space-y-5",children:d("div",{className:"flex flex-wrap -mx-4",children:[t("div",{className:"w-full lg:w-1/3 px-4",children:t("div",{className:"panel",children:d("div",{className:"panel-body",children:[d("div",{className:"form-group",children:[t("label",{htmlFor:"name",children:"Name"}),t("input",{name:"name",type:"text",placeholder:"Name",className:"form-input",value:o.name,onChange:B}),b.name&&t("span",{className:"text-red-500 text-sm",children:b.name[0]})]}),t("div",{className:"sm:col-span-2 flex justify-end mt-3",children:t("button",{type:"submit",className:"btn btn-primary w-full sm:w-auto",children:" Submit "})})]})})}),t("div",{className:"w-full lg:w-2/3 px-2 mt-6 lg:mt-0 md-mt-0",children:t("div",{className:"datatables",children:t(j,{title:"List of all Roles",columns:[{accessor:"id",title:"#",sortable:!0},{accessor:"name",title:"Name",sortable:!0},{accessor:"action",title:"Action",sortable:!0,render:e=>d("div",{className:"flex space-x-2",children:[t("button",{type:"button",onClick:()=>I(e),className:"btn px-1 py-0.5 rounded text-white bg-info",children:t(L,{})}),t("button",{type:"button",onClick:()=>R(e.id),className:"btn px-1 py-0.5 rounded text-white",style:{background:"#d33",color:"#fff"},children:t($,{})})]})}],rows:k})})})]})})};export{H as default};
