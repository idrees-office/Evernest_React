import{X as C,u as A,r as s,T as $,j as e,a,A as _,Y as w,ag as z,c as M,S as N}from"./index-c5439c4c.js";import{I as U}from"./IconBell-4a11cbe9.js";import{I as Q}from"./IconPlus-2b72e8a9.js";import{Y as v,y as F}from"./transition-99725022.js";/* empty css                  */import{T as X}from"./Table-d620ae2d.js";import{I as H}from"./IconPencil-3e55b509.js";import{I as J}from"./IconTrashLines-ae647d74.js";import"./index-25858b06.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./extends-4c19d496.js";const V={createApi:`${C()}/subscriber/store`},q=({isOpen:l,onClose:d,onSuccess:f})=>{A();const[r,m]=s.useState({}),n=s.useRef({subscriberform:null}),b=$(),[g,y]=s.useState([]),[P,S]=s.useState();s.useEffect(()=>{l&&m({});const o=JSON.parse(localStorage.getItem("permissions")||"[]"),c=localStorage.getItem("role")||"";y(o),S(c)},[l]);const u=async o=>{if(o.preventDefault(),n.current.subscriberform){const c=new FormData(n.current.subscriberform);try{const i=await w.post(V.createApi,c);if(i.status===200||i.status===201)b.success("Lead Create Successfully"),d(),m({}),n.current.subscriberform.reset(),f();else return}catch(i){i.response.status===422&&m(i.response.data||{})}}};return e(v,{appear:!0,show:l,as:s.Fragment,children:a(F,{as:"div",open:l,onClose:d,className:"relative z-[51]",children:[e(v.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0",enterTo:"opacity-100",leave:"ease-in duration-200",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:e("div",{className:"fixed inset-0 bg-[black]/60"})}),e("div",{className:"fixed inset-0 overflow-y-auto",children:e("div",{className:"flex min-h-full items-center justify-center px-4 py-8",children:e(v.Child,{as:s.Fragment,enter:"ease-out duration-300",enterFrom:"opacity-0 scale-95",enterTo:"opacity-100 scale-100",leave:"ease-in duration-200",leaveFrom:"opacity-100 scale-100",leaveTo:"opacity-0 scale-95",children:a(F.Panel,{className:"panel border-0 p-0 rounded-lg overflow-hidden w-full max-w-lg text-black dark:text-white-dark",children:[e("button",{type:"button",onClick:d,className:"absolute top-4 ltr:right-4 rtl:left-4 text-gray-400 hover:text-gray-800 dark:hover:text-gray-600 outline-none",children:e(_,{})}),e("div",{className:"text-lg font-medium bg-[#fbfbfb] dark:bg-[#121c2c] ltr:pl-5 rtl:pr-5 py-3 ltr:pr-[50px] rtl:pl-[50px]",children:" Add Subscrber Infomation..."}),e("div",{className:"p-5",children:a("form",{className:"leadForm",ref:o=>n.current.subscriberform=o,onSubmit:u,children:[a("div",{className:"mb-3",children:[e("label",{htmlFor:"name",children:"Name "}),e("input",{id:"name",type:"text",placeholder:"Full Name",name:"name",className:"form-input"}),(r==null?void 0:r.name)&&e("p",{className:"text-danger error",children:r.name[0]})]}),a("div",{className:"mb-3",children:[e("label",{htmlFor:"email",children:"Email "}),e("input",{id:"email",type:"text",name:"email",placeholder:"john@gmail.com",className:"form-input"}),(r==null?void 0:r.email)&&e("p",{className:"text-danger error",children:r.email[0]})]}),a("div",{className:"mb-3",children:[e("label",{htmlFor:"phone",children:"Phone"}),e("input",{id:"text",type:"text",name:"phone",placeholder:"Phone",className:"form-input"}),(r==null?void 0:r.phone)&&e("p",{className:"text-danger error",children:r.phone[0]})]}),a("div",{className:"ltr:text-right rtl:text-left flex justify-end items-center mt-8",children:[e("button",{type:"button",className:"btn btn-outline-danger",onClick:d,children:" Cancel "}),e("button",{type:"submit",className:"btn btn-primary ltr:ml-4 rtl:mr-4",children:"Save"})]})]})})]})})})})]})})},G={listApi:`${C()}/subscriber/show`},ce=()=>{A();const l=z();M(),l.state;const[d,f]=s.useState(!1),[r,m]=s.useState(!1),[n,b]=s.useState(1),[g,y]=s.useState(10),[P,S]=s.useState(0),[u,o]=s.useState({columnAccessor:"id",direction:"asc"}),[c,i]=s.useState(""),[k,E]=s.useState([]);s.useEffect(()=>{x()},[n,g,u,c]);const x=async()=>{var t;try{m(!0);const h={page:n,per_page:g,sort_field:u.columnAccessor,sort_order:u.direction,search:c},p=await w.get(G.listApi,{params:h});p.data&&(E(p.data.data||[]),S(p.data.total||0))}catch(h){((t=h.response)==null?void 0:t.status)===403&&(window.location.href="/error"),I("Something wrong on server")}finally{m(!1)}},j=t=>{N.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:t,icon:"success"})},I=t=>{N.fire({text:t,icon:"error",title:"Server Error"})},B=()=>{f(!0)},D=t=>{i(t.target.value),b(1)},R=(Array.isArray(k)?k:[]).map((t,h)=>({id:t.id,name:t.name,email:t.email,phone:t.phone,source:t.status})),L=async()=>{window.open("https://backend.leadshub.ae/add-subscriber","_blank")},Y=async t=>{var p;if((await N.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{(await w.delete(`${C()}/subscriber/delete/${t}`)).status===200&&(j("Subscriber deleted successfully"),x())}catch(T){((p=T.response)==null?void 0:p.status)===403&&(window.location.href="/error"),I("Something wrong on server")}};return a("div",{children:[a("div",{className:"panel flex items-center justify-between overflow-visible whitespace-nowrap p-3 text-dark relative",children:[a("div",{className:"flex items-center",children:[e("div",{className:"rounded-full bg-primary p-1.5 text-white ring-2 ring-primary/30 ltr:mr-3 rtl:ml-3",children:e(U,{})}),e("span",{className:"ltr:mr-3 rtl:ml-3",children:"Details of Your Email Subscriber: "}),a("button",{onClick:L,className:"btn btn-primary btn-sm",children:[" ",e(Q,{})," Import Contact"," "]})]}),e("div",{className:"",children:e("button",{className:"btn btn-primary btn-sm",type:"button",onClick:B,children:"Create Single"})})]}),e("div",{className:"datatables mt-6",children:e(X,{title:"List of all users:",columns:[{accessor:"id",title:"#",sortable:!0},{accessor:"name",title:"Name",sortable:!0},{accessor:"email",title:"Email",sortable:!0},{accessor:"phone",title:"Phone",sortable:!0},{accessor:"source",title:"Source",sortable:!0,render:t=>{switch(t.source){case 1:return e("span",{className:"badge bg-success",children:"Subscriber"});case 2:return e("span",{className:"badge bg-secondary",children:"Inactive"});case 3:return e("span",{className:"badge bg-danger",children:"Unsubscribed"});default:return e("span",{className:"badge bg-light",children:"Unknown"})}}},{accessor:"action",title:"Action",sortable:!1,render:t=>a("div",{className:"flex space-x-2",children:[e("button",{type:"button",className:"btn px-1 py-0.5 rounded text-white bg-info",children:e(H,{})}),e("button",{type:"button",onClick:()=>Y(t.id),className:"btn px-1 py-0.5 rounded text-white bg-red-600",children:e(J,{})})]})}],rows:R,totalRecords:P,currentPage:n,recordsPerPage:g,onPageChange:t=>b(t),onRecordsPerPageChange:t=>{y(t),b(1)},onSortChange:o,onSearchChange:D,sortStatus:u,isLoading:r,minHeight:200,noRecordsText:"No subscribers found",searchValue:c})}),e(q,{isOpen:d,onClose:()=>f(!1),onSuccess:x})]})};export{ce as default};
