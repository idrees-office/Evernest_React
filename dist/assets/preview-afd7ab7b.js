import{r as c,R as Y,W as ae,al as ne,c as re,T as ie,j as e,a as n,d as M,X as se}from"./index-a79c8e64.js";/* empty css                  */import{F as oe}from"./flatpickr-6c861511.js";var le=globalThis&&globalThis.__rest||function(t,l){var v={};for(var m in t)Object.prototype.hasOwnProperty.call(t,m)&&l.indexOf(m)<0&&(v[m]=t[m]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,m=Object.getOwnPropertySymbols(t);s<m.length;s++)l.indexOf(m[s])<0&&Object.prototype.propertyIsEnumerable.call(t,m[s])&&(v[m[s]]=t[m[s]]);return v};function ce(t){const l=parseFloat(t);return!isNaN(l)&&isFinite(l)}function V(t){return typeof t=="string"&&t[t.length-1]==="%"&&ce(t.substring(0,t.length-1))}function W(t,l){l===0&&(t!=null&&t.style)&&(t.style.display="none")}function de(t,l){l===0&&(t!=null&&t.style)&&(t.style.display="")}const me={animating:"rah-animating",animatingUp:"rah-animating--up",animatingDown:"rah-animating--down",animatingToHeightZero:"rah-animating--to-height-zero",animatingToHeightAuto:"rah-animating--to-height-auto",animatingToHeightSpecific:"rah-animating--to-height-specific",static:"rah-static",staticHeightZero:"rah-static--height-zero",staticHeightAuto:"rah-static--height-auto",staticHeightSpecific:"rah-static--height-specific"};function X(t,l){return[t.static,l===0&&t.staticHeightZero,l>0&&t.staticHeightSpecific,l==="auto"&&t.staticHeightAuto].filter(v=>v).join(" ")}const L=t=>{var{animateOpacity:l=!1,animationStateClasses:v={},applyInlineTransitions:m=!0,children:s,className:S="",contentClassName:C,delay:i=0,duration:N=500,easing:_="ease",height:a,onHeightAnimationEnd:f,onHeightAnimationStart:y,style:h}=t,T=le(t,["animateOpacity","animationStateClasses","applyInlineTransitions","children","className","contentClassName","delay","duration","easing","height","onHeightAnimationEnd","onHeightAnimationStart","style"]);const w=c.useRef(a),p=c.useRef(null),j=c.useRef(),k=c.useRef(),g=c.useRef(Object.assign(Object.assign({},me),v)),d=typeof window<"u",o=c.useRef(d&&window.matchMedia?window.matchMedia("(prefers-reduced-motion)").matches:!1),r=o.current?0:i,x=o.current?0:N;let A=a,E="visible";typeof A=="number"?(A=a<0?0:a,E="hidden"):V(A)&&(A=a==="0%"?0:a,E="hidden");const[D,F]=c.useState(A),[q,P]=c.useState(E),[G,$]=c.useState(!1),[J,R]=c.useState(X(g.current,a));c.useEffect(()=>{W(p.current,D)},[]),c.useEffect(()=>{if(a!==w.current&&p.current){de(p.current,w.current),p.current.style.overflow="hidden";const Z=p.current.offsetHeight;p.current.style.overflow="";const z=x+r;let b,u,I="hidden",B;const U=w.current==="auto";typeof a=="number"?(b=a<0?0:a,u=b):V(a)?(b=a==="0%"?0:a,u=b):(b=Z,u="auto",I=void 0),U&&(u=b,b=Z);const ee=[g.current.animating,(w.current==="auto"||a<w.current)&&g.current.animatingUp,(a==="auto"||a>w.current)&&g.current.animatingDown,u===0&&g.current.animatingToHeightZero,u==="auto"&&g.current.animatingToHeightAuto,u>0&&g.current.animatingToHeightSpecific].filter(te=>te).join(" "),K=X(g.current,u);F(b),P("hidden"),$(!U),R(ee),clearTimeout(k.current),clearTimeout(j.current),U?(B=!0,k.current=setTimeout(()=>{F(u),P(I),$(B),y==null||y(u)},50),j.current=setTimeout(()=>{$(!1),R(K),W(p.current,u),f==null||f(u)},z)):(y==null||y(b),k.current=setTimeout(()=>{F(u),P(I),$(!1),R(K),a!=="auto"&&W(p.current,b),f==null||f(b)},z))}return w.current=a,()=>{clearTimeout(k.current),clearTimeout(j.current)}},[a]);const H=Object.assign(Object.assign({},h),{height:D,overflow:q||(h==null?void 0:h.overflow)});G&&m&&(H.transition=`height ${x}ms ${_} ${r}ms`,h!=null&&h.transition&&(H.transition=`${h.transition}, ${H.transition}`),H.WebkitTransition=H.transition);const O={};l&&(O.transition=`opacity ${x}ms ${_} ${r}ms`,O.WebkitTransition=O.transition,D===0&&(O.opacity=0));const Q=typeof T["aria-hidden"]<"u"?T["aria-hidden"]:a===0;return Y.createElement("div",Object.assign({},T,{"aria-hidden":Q,className:`${J} ${S}`,style:H}),Y.createElement("div",{className:C,style:O,ref:p},s))},ue={createApi:`${ae()}/subscriber/send-campaign`},ge=()=>{const t=ne();re();const l=ie(),{htmlCode:v,cssCode:m}=t.state||{htmlCode:"",cssCode:""},[s,S]=c.useState("1"),C=c.useRef({emailform:null}),[i,N]=c.useState({}),[_,a]=c.useState(!1),[f,y]=c.useState(""),h=d=>{S(o=>o===d?"":d)},T=()=>v,w=async d=>{if(d.preventDefault(),C.current.emailform){const o=new FormData(C.current.emailform);if(o.append("body",T()),o.append("schedule_at",f),!o.has("send_to_all")){l.error("Please select at least one subscriber to send the email."),N({send_to_all:["Please select at least one subscriber to send the email."]}),S("1");return}try{const r=await se.post(ue.createApi,o);alert("Emails are being sent in the background!")}catch(r){r.response&&r.response.status===422&&(S("2"),N(r.response.data))}}},p=d=>{const r=d.target.name;i[r]&&N(x=>({...x,[r]:""}))},j=d=>{const r=d.target.name;i[r]&&N(x=>({...x,[r]:""}))},k=d=>{const o=d.target.checked;o&&y(""),N(r=>({...r,sendNow:"",date:o?"":r.date})),a(o),!o&&!f&&(N(r=>({...r,date:["Please select a date for scheduled sending"]})),S("3"))},g=d=>{a(!1);const o=d[0];y(o),N(r=>({...r,date:""}))};return e("div",{children:e("div",{className:"min-h-screen p-2 sm:p-4",children:n("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-4 min-h-[calc(100vh-200px)]",children:[n("div",{className:"md:col-span-8 panel p-3 sm:p-4 border rounded bg-white shadow h-[calc(100vh-140px)] md:h-[calc(100vh-140px)] overflow-auto",children:[e("h2",{className:"text-lg font-bold mb-3",children:"HTML Code"}),e("div",{className:"mb-5",children:n("form",{className:"emailform",ref:d=>C.current.emailform=d,onSubmit:w,onKeyUp:p,children:[n("div",{className:"space-y-2 font-semibold",children:[n("div",{className:`border rounded ${i.send_to_all?"border-red-400":"border-[#d3d3d3] dark:border-[#1b2e4b]"}`,children:[n("button",{type:"button",className:`p-4 w-full flex items-center text-white-dark dark:bg-[#1b2e4b] ${s==="1"?"!text-primary":""}`,onClick:()=>h("1"),children:["To, Who are you sending this email to?",e("div",{className:`ltr:ml-auto rtl:mr-auto ${s==="1"?"rotate-180":""}`,children:e(M,{})})]}),e("div",{children:e(L,{duration:300,height:s==="1"?"auto":0,children:e("div",{className:"space-y-2 p-4 text-white-dark text-[13px] border-t border-[#d3d3d3] dark:border-[#1b2e4b]",children:e("div",{className:"mb-3",children:n("label",{className:"inline-flex",children:[e("input",{type:"checkbox",name:"send_to_all",className:"form-checkbox text-secondary rounded-full peer"}),e("span",{className:"peer-checked:text-secondary",children:"Send Email to All Subscribers"})]})})})})})]}),n("div",{className:`border rounded ${i.name||i.subject||i.email?"border-red-400":"border-[#d3d3d3] dark:border-[#1b2e4b]"}`,children:[n("button",{type:"button",className:`p-4 w-full flex items-center text-white-dark dark:bg-[#1b2e4b] ${s==="2"?"!text-primary":""}`,onClick:()=>h("2"),children:[" From: Who is sending this email?",n("div",{className:`ltr:ml-auto rtl:mr-auto ${s==="2"?"rotate-180":""}`,children:[" ",e(M,{})," "]})]}),e("div",{children:e(L,{duration:300,height:s==="2"?"auto":0,children:n("div",{className:"space-y-2 p-4 text-white-dark text-[13px] border-t border-[#d3d3d3] dark:border-[#1b2e4b]",children:[n("div",{className:"mb-3",children:[e("label",{htmlFor:"name",children:"Campaign Name "}),e("input",{id:"name",type:"text",name:"name",placeholder:"Evernest Real Estate",className:"form-input",autoComplete:"off"}),i.name&&e("span",{className:"text-red-500 text-sm",children:i.name})]}),n("div",{className:"mb-3",children:[e("label",{htmlFor:"subject",children:"Subject "}),e("input",{id:"subject",type:"text",name:"subject",placeholder:"Subject",className:"form-input",autoComplete:"off"}),i.subject&&e("span",{className:"text-red-500 text-sm",children:i.subject})]}),n("div",{className:"mb-3",children:[e("label",{htmlFor:"from_email",children:"Email "}),n("select",{id:"from_email",name:"from_email",className:"form-select",defaultValue:"",onChange:j,children:[e("option",{value:"",disabled:!0,children:"Select Email"}),e("option",{value:"evernestre@gmail.com",children:"evernestre@gmail.com"}),e("option",{value:"info@evernestre.ae",children:"info@evernestre.ae"})]}),i.from_email&&e("span",{className:"text-red-500 text-sm",children:i.from_email})]})]})})})]}),n("div",{className:`border rounded ${i.sendNow||i.date?"border-red-400":"border-[#d3d3d3] dark:border-[#1b2e4b]"}`,children:[n("button",{type:"button",className:`p-4 w-full flex items-center text-white-dark dark:bg-[#1b2e4b] ${s==="3"?"!text-primary":""}`,onClick:()=>h("3"),children:[" Send Options",e("div",{className:`ltr:ml-auto rtl:mr-auto ${s==="3"?"rotate-180":""}`,children:e(M,{})})]}),e("div",{children:e(L,{duration:300,height:s==="3"?"auto":0,children:n("div",{className:"p-4 text-[13px] border-t border-[#d3d3d3] dark:border-[#1b2e4b]",children:[n("div",{className:"space-y-4 p-4 text-white-dark text-[13px] border-t border-[#d3d3d3] dark:border-[#1b2e4b]",children:[n("div",{className:"flex items-center justify-between mb-3",children:[e("label",{htmlFor:"sendNow",className:"mr-2",style:{cursor:"pointer"},children:e("h1",{children:"Send Now"})}),e("input",{id:"sendNow",type:"checkbox",name:"sendNow",className:"form-checkbox",onChange:k})]}),i.sendNow&&e("span",{className:"text-red-500 text-sm",children:i.sendNow}),e("hr",{}),n("div",{className:"mt-4",children:[e("label",{htmlFor:"slugmark",className:"text-white-dark",children:" Date"}),e(oe,{value:f,name:"scheduled_at",options:{dateFormat:"Y-m-d H:i",enableTime:!0},className:"form-input",onChange:g,disabled:_,placeholder:"Y-m-d H:i"}),i.date&&e("span",{className:"text-red-500 text-sm",children:i.date})]})]}),e("hr",{})]})})})]})]}),e("div",{className:"mb-3",children:e("button",{type:"submit",className:"mt-3 btn btn-secondary text-white rounded",children:" Send "})})]})})]}),n("div",{className:"md:col-span-4 panel p-3 sm:p-4 border rounded bg-white shadow h-[50vh] md:h-[calc(100vh-140px)]",children:[e("h2",{className:"text-lg font-bold mb-3",children:"Live Preview"}),e("div",{className:"h-[calc(100%-2rem)]",children:e("iframe",{title:"preview",className:"w-full h-full border rounded",srcDoc:T(),scrolling:"no",seamless:!0,style:{width:"100%",height:"100%",border:"none"}})})]})]})})})};export{ge as default};
