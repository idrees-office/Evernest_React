import{X as g,u as te,r as o,s as se,Y as u,S as p,b as t,j as s}from"./index-f71476f7.js";import{o as D,L as O}from"./status-483caa94.js";import{S as R}from"./react-select.esm-f0223add.js";import{I as re}from"./IconTrashLines-de68c122.js";import{I as ae}from"./IconPencil-61864d41.js";import{T as oe}from"./Table-c4ae9a6d.js";/* empty css                  */import{I as E}from"./Icon-35707edd.js";import"./IconSquareCheck-8a60de1e.js";import"./IconStar-1d1757e4.js";import"./IconTrash-d378d806.js";import"./objectWithoutPropertiesLoose-f3b3ace0.js";import"./extends-4c19d496.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./index-c18cdd2b.js";import"./IconBell-4219e731.js";import"./IconClock-34fe7dc3.js";import"./IconLink-3a92234c.js";import"./IconEye-4d3ce8fe.js";import"./IconHome-0f63648a.js";import"./IconMail-6f9e0f48.js";import"./IconPlus-2705bd99.js";import"./IconSquareRotated-5178ee16.js";import"./IconTwitter-89259c98.js";import"./IconGoogle-68fccf56.js";import"./IconHorizontalDots-ba2dff3b.js";import"./IconNotesEdit-ffbaaaaa.js";import"./IconLockDots-0c59eac7.js";const m={createApi:`${g()}/statuses/create`,listApi:`${g()}/statuses/show`,destoryApi:`${g()}/statuses/delete`,updateStatusApi:`${g()}/statuses/update_stage`},Oe=()=>{const A=te(),i=o.useRef({userformRef:null}),[L,T]=o.useState([]),[B,b]=o.useState(null),[a,P]=o.useState({});o.useState(null);const[le,U]=o.useState(null),$=o.useRef(!1),[S,x]=o.useState(1),[N,z]=o.useState(10),[j,q]=o.useState(0),[h,Y]=o.useState({columnAccessor:"id",direction:"asc"}),[y,H]=o.useState(""),[Q,w]=o.useState(null),[M,v]=o.useState(null);o.useEffect(()=>{$.current||(A(se("Create User")),$.current=!0)},[A]),o.useEffect(()=>{_()},[S,N,h,y]);const _=async()=>{var e;try{const r={page:S,per_page:N,sort_field:h.columnAccessor,sort_order:h.direction,search:y},l=await u.get(m.listApi,{params:r});l.data&&(T(l.data.data||[]),q(l.data.total||0))}catch(r){((e=r.response)==null?void 0:e.status)===403&&(window.location.href="/error"),k()}},V=async e=>{var l,n,d,f;e.preventDefault();let r=null;try{if(i.current.userformRef){const c=new FormData(i.current.userformRef),F=c.get("id");r=c.get("name");const I=F?await u.post(`${m.createApi}/${F}`,c):await u.post(m.createApi,c);(I.status===200||I.status===201)&&(C(I.data.message),_(),P({}),i.current.userformRef.reset(),U(null),b(null),w(null),v(null))}}catch(c){(n=(l=c.response)==null?void 0:l.data)!=null&&n.errors?P(c.response.data.errors):((d=c.response)==null?void 0:d.status)===403||(((f=c.response)==null?void 0:f.status)===422?p.fire({title:""+c.response.data.message,icon:"error",text:`Total ${r} : ${c.response.data.count}`}):k())}},C=e=>{p.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:e,icon:"success"})},k=()=>{p.fire({text:"Something went wrong on the server",icon:"error",title:"Server Error"})},X=async e=>{if(i.current.userformRef){const r=i.current.userformRef;r.id.value=e.id||"",r.name.value=e.name||"",r.type.value=e.type||"",r.status_old_id.value=e.status_old_id||"",r.sort_order.value=e.sort_order||"",r.color.value=e.color||"",b(e.status||""),w(e.status_for||""),v(e.icon!==null?Number(e.icon):null),setTimeout(()=>{const l=r.querySelector('input[type="color"]');l&&l.click()},100)}},G=async e=>{var l;if((await p.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const n=await u.delete(m.destoryApi+`/${e.id}`);(n.status===200||n.status===201)&&(C("User deleted successfully"),_())}catch(n){((l=n.response)==null?void 0:l.status)===403&&(window.location.href="/error"),k()}},J=e=>{H(e.target.value),x(1)},K=e=>{x(e)},W=e=>{z(e),x(1)},Z=async e=>{var l;if(!e||!e.id){console.error("Invalid item or item ID not found");return}const r=e.status==1?2:1;try{const n=new FormData;n.append("id",e.id?e.id:""),n.append("status",r.toString());const d=await u.post(m.updateStatusApi,n);(d.status===200||d.status===201)&&(C("Update status successfully"),T(f=>f.map(c=>c.id===e.id?{...c,status:r}:c)))}catch(n){((l=n.response)==null?void 0:l.status)===422&&p.fire({title:""+n.response.data.message,icon:"error",text:`Total ${e.name} : ${n.response.data.count}`})}},ee=[{accessor:"id",title:"#",width:80,key:"id"},{accessor:"name",title:"Name",sortable:!0},{accessor:"color",title:"Color",sortable:!0,render:e=>s("div",{className:"flex items-center space-x-2",children:[t("div",{className:"w-5 h-5 rounded-full border",style:{backgroundColor:e.color}}),t("span",{children:e.color})]})},{accessor:"type",title:"Type",width:120,render:e=>t("div",{className:"flex space-x-2",children:s("span",{className:"badge bg-info",children:[" ",e.type," "]})})},{accessor:"status_old_id",title:"Old Id",width:120,render:e=>t("div",{className:"flex space-x-2",children:s("span",{className:"badge bg-success",children:[" ",e.status_old_id," "]})})},{accessor:"status",title:"Hide | Show",width:120,key:"actions-column2",render:e=>t("div",{className:"flex space-x-1",children:s("label",{className:"w-12 h-6 relative",children:[t("input",{onChange:()=>Z(e),checked:e.status===1,type:"checkbox",className:"custom_switch absolute w-full h-full opacity-0 z-10 cursor-pointer peer",id:"custom_switch_checkbox1"}),t("span",{className:"bg-[#ebedf2] dark:bg-dark block h-full before:absolute before:left-1 before:bg-white dark:before:bg-white-dark dark:peer-checked:before:bg-white before:bottom-1 before:w-4 before:h-4 peer-checked:before:left-7 peer-checked:bg-success before:transition-all before:duration-300 "})]})})},{accessor:"actions",title:"Actions",width:120,key:"actions-column",render:e=>s("div",{className:"flex space-x-2",children:[t("button",{type:"button",onClick:()=>X(e),className:"btn px-1 py-0.5 rounded text-white bg-info",children:t(ae,{})},`edit-${e.client_user_id}`),t("button",{type:"button",onClick:()=>G(e),className:"btn px-1 py-0.5 rounded text-white bg-red-600",children:t(re,{})},`delete-${e.client_user_id}`)]})}];return t("form",{ref:e=>i.current.userformRef=e,onSubmit:V,className:"space-y-5",children:s("div",{className:"flex flex-wrap -mx-4",children:[t("div",{className:"w-full lg:w-1/3 px-4",children:t("div",{className:"panel",children:t("div",{className:"panel-body",children:s("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[s("div",{className:"form-group",children:[t("label",{htmlFor:"name",children:"Stage Name"}),t("input",{name:"name",type:"text",placeholder:"Name",className:"form-input"}),t("input",{type:"hidden",name:"id",id:"id"}),a.name&&s("span",{className:"text-red-500 text-sm",children:[" ",a.name," "]})]}),s("div",{className:"form-group",children:[t("label",{htmlFor:"color",children:"Stage Color"}),t("input",{name:"color",type:"color",required:!0,placeholder:"Color",className:"form-input",style:{height:"37px"}}),a.color&&s("span",{className:"text-red-500 text-sm",children:[" ",a.color," "]})]}),s("div",{className:"form-group",children:[t("label",{htmlFor:"type",children:"Stage Type"}),t("input",{name:"type",type:"text",placeholder:"sidebar | top-bar means dashboard",className:"form-input"}),a.type&&s("span",{className:"text-red-500 text-sm",children:[" ",a.type," "]})]}),s("div",{className:"form-group",children:[t("label",{htmlFor:"status",children:"Stage Status"}),t(R,{name:"status",placeholder:"Select an option",options:D,value:D.find(e=>e.value===B),onChange:e=>b((e==null?void 0:e.value)||null)}),a.status&&s("span",{className:"text-red-500 text-sm",children:[" ",a.status," "]})]}),s("div",{className:"form-group",children:[t("label",{htmlFor:"status_for",children:"Stage For"}),t(R,{name:"status_for",placeholder:"Select an option",options:O,value:O.find(e=>e.value===Q),onChange:e=>w((e==null?void 0:e.value)||null)}),a.status_for&&s("span",{className:"text-red-500 text-sm",children:[" ",a.status_for," "]})]}),s("div",{className:"form-group",children:[t("label",{htmlFor:"sort_order",children:"Sort Order"}),t("input",{name:"sort_order",type:"number",placeholder:"Sort Order",className:"form-input"}),a.sort_order&&s("span",{className:"text-red-500 text-sm",children:[" ",a.sort_order," "]})]}),s("div",{className:"form-group",children:[t("label",{htmlFor:"status_old_id",children:"Stage Old Id"}),t("input",{name:"status_old_id",type:"number",placeholder:"Status Old Id",className:"form-input w-full"}),a.status_old_id&&s("span",{className:"text-red-500 text-sm",children:[" ",a.status_old_id," "]})]}),s("div",{className:"form-group",children:[t("label",{htmlFor:"icon",children:"Icon"}),t(R,{name:"icon",placeholder:"Select an option",options:E,value:E.find(e=>e.value===M),onChange:e=>v((e==null?void 0:e.value)??null),formatOptionLabel:e=>s("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[" ",e.label," ",t("span",{children:e.iconName})," "]})}),a.icon&&s("span",{className:"text-red-500 text-sm",children:[" ",a.icon," "]})]}),t("div",{className:"sm:col-span-2",children:t("button",{type:"submit",className:"btn btn-primary w-full",children:"Submit"})})]})})})}),t("div",{className:"w-full lg:w-2/3 px-2 mt-6 lg:mt-0 md-mt-0",children:t("div",{className:"datatables",children:t(oe,{columns:ee,rows:L,title:"All Leads Stages",idAccessor:"id",totalRecords:j,currentPage:S,recordsPerPage:N,onPageChange:K,onRecordsPerPageChange:W,onSortChange:Y,onSearchChange:J,sortStatus:h,isLoading:!1,minHeight:200,noRecordsText:"No Stage found",searchValue:y})})})]})})};export{Oe as default};
