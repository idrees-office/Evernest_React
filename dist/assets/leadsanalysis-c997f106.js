import{u as _,r as n,b as u,s as A,j as t,a,L as x,P as L,F as j,N as F}from"./index-933fe52f.js";import{_ as y,I}from"./IconChatDots-41444a97.js";import{a as T}from"./IconSquareCheck-3589aa9d.js";import{t as E}from"./status-6cf75f77.js";import"./IconStar-50f6415f.js";import"./IconTrash-0cf9ab89.js";const U=()=>{var g;const c=_(),[w,h]=n.useState(!0),[i,N]=n.useState(null),[p,v]=n.useState(null),k=E(),d=u(e=>e.themeConfig.theme==="dark"||e.themeConfig.isDarkMode),m=u(e=>e.themeConfig.rtlClass)==="rtl";n.useEffect(()=>{c(A("Leads Analysis"))},[c]),n.useEffect(()=>{(async()=>{try{h(!0);const r=await F.get("/leads/leads-analysis");if(r.status===200)N(r.data.data);else throw new Error("Failed to fetch data")}catch(r){v(r)}finally{h(!1)}})()},[]);const S=e=>{if(!(i!=null&&i.daily_counts))return[];const r=i.daily_counts[e]||{},s=Object.entries(r).sort(([l],[o])=>new Date(l).getTime()-new Date(o).getTime()).map(([l,o])=>({x:l,y:o}));return[{name:e,data:s.length>0?s:[{x:new Date().toISOString().split("T")[0],y:0}]}]},D=e=>({chart:{height:160,type:"area",fontFamily:"Nunito, sans-serif",sparkline:{enabled:!0}},stroke:{curve:"smooth",width:2},colors:[e],fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.1,stops:[0,90,100]}},grid:{padding:{top:5}},yaxis:{show:!1},tooltip:{x:{show:!0,format:"dd MMM yyyy"},y:{title:{formatter:()=>""}}}}),f=["#4361ee","#805dca","#00ab55","#e7515a"],C=(e,r)=>{const s=k.find(o=>o.label===e),l=f[r%f.length];return{icon:(s==null?void 0:s.icon)||t(T,{className:"w-5 h-5"}),bgColor:s?`${s.bgColor}/10`:"bg-primary/10",color:l}};if(w)return t("div",{className:"text-center py-10",children:"Loading..."});if(p)return a("div",{className:"text-center py-10 text-danger",children:["Error: ",p.message]});if(!i)return t("div",{className:"text-center py-10",children:"No data available"});const b={series:[{name:"Direct",data:[58,44,55,57,56,61,58,63,60,66,56,63]},{name:"Organic",data:[91,76,85,101,98,87,105,91,114,94,66,70]}],options:{chart:{height:360,type:"bar",fontFamily:"Nunito, sans-serif",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{width:2,colors:["transparent"]},colors:["#5c1ac3","#ffbb44"],dropShadow:{enabled:!0,blur:3,color:"#515365",opacity:.4},plotOptions:{bar:{horizontal:!1,columnWidth:"55%",borderRadius:8,borderRadiusApplication:"end"}},legend:{position:"bottom",horizontalAlign:"center",fontSize:"14px",itemMargin:{horizontal:8,vertical:8}},grid:{borderColor:d?"#191e3a":"#e0e6ed",padding:{left:20,right:20},xaxis:{lines:{show:!1}}},xaxis:{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],axisBorder:{show:!0,color:d?"#3b3f5c":"#e0e6ed"}},yaxis:{tickAmount:6,opposite:!!m,labels:{offsetX:m?-10:0}},fill:{type:"gradient",gradient:{shade:d?"dark":"light",type:"vertical",shadeIntensity:.3,inverseColors:!1,opacityFrom:1,opacityTo:.8,stops:[0,100]}},tooltip:{marker:{show:!0}}}};return a("div",{children:[a("div",{className:"flex items-center justify-between mb-6",children:[a("ul",{className:"flex space-x-2 rtl:space-x-reverse",children:[t("li",{children:t(x,{to:"/",className:"text-primary hover:underline",children:"Dashboard"})}),t("li",{className:"before:content-['/'] ltr:before:mr-2 rtl:before:ml-2",children:t("span",{children:"Analytics"})})]}),t(x,{to:"/pages/leads/dashboard",className:"btn btn-success btn-sm flex items-center gap-2",children:" Lead Dashboard "})]}),a("div",{className:"pt-5",children:[t("div",{className:"grid sm:grid-cols-2 xl:grid-cols-4 gap-6 mb-6",children:Object.entries(i.percentages).map(([e,r],s)=>{const l=C(e,s);return a("div",{className:"panel h-full p-0 rounded-2xl shadow-md bg-white dark:bg-gray-900",children:[a("div",{className:"flex items-center p-5",children:[t("div",{className:`flex items-center justify-center w-12 h-12 rounded-full ${l.bgColor}`,style:{color:l.color},children:l.icon}),a("div",{className:"ml-4",children:[a("p",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:[r,"%"]}),t("span",{className:"text-sm text-gray-500 dark:text-white-light",children:e}),a("p",{className:"text-sm text-gray-500 dark:text-white-light mt-1",children:[i.status_counts[e]," leads"]})]})]}),t("div",{className:"relative h-40",children:t(y,{series:S(e),options:D(l.color),type:"area",height:160,className:"absolute bottom-0 w-full overflow-hidden"})})]},e)})}),a("div",{className:"grid lg:grid-cols-3 gap-6 mb-6",children:[a("div",{className:"panel h-full p-0 lg:col-span-2",children:[t("div",{className:"flex items-start justify-between dark:text-white-light mb-5 p-5 border-b  border-white-light dark:border-[#1b2e4b]",children:t("h5",{className:"font-semibold text-lg ",children:"Unique Visitors"})}),t(y,{options:b.options,series:b.series,type:"bar",height:360,className:"overflow-hidden"})]}),a("div",{className:"panel h-full",children:[t("div",{className:"flex items-start justify-between dark:text-white-light mb-5 -mx-5 p-5 pt-0 border-b border-white-light dark:border-[#1b2e4b]",children:t("h5",{className:"font-semibold text-lg",children:"Last Activities Report"})}),t(L,{className:"perfect-scrollbar relative h-[360px] ltr:pr-3 rtl:pl-3 ltr:-mr-3 rtl:-ml-3",children:t("div",{className:"space-y-7",children:(g=i.recent_comments)==null?void 0:g.map((e,r)=>{var s;return a("div",{className:"flex",children:[t("div",{className:"shrink-0 ltr:mr-2 rtl:ml-2 relative z-10 before:w-[2px] before:h-[calc(100%-24px)] before:bg-white-dark/30 before:absolute before:top-10 before:left-4",children:t("div",{className:"bg-primary shadow-primary w-8 h-8 rounded-full flex items-center justify-center text-white",children:t(I,{className:"w-4 h-4"})})}),a("div",{children:[a("h5",{className:"font-semibold dark:text-white-light",children:[" ",e.lead_comment," "]}),a("p",{className:"text-white-dark text-xs",children:["Lead : ",e.lead.lead_title," | ",e.created_at]}),"Responsible Agent: ",t("span",{className:"badge bg-success text-white",children:e.agent_id?a(j,{children:[" ",((s=e==null?void 0:e.agents)==null?void 0:s.client_user_name)||"Null"," "]}):t("span",{className:"badge bg-success text-white",children:"No Agent Assigned"})})]})]},e.lead_comment_id)})})})]})]})]})]})};export{U as default};
