import{W as c,u as j,r as l,s as B,X as d,S as v,j as e,a}from"./index-fe5baaac.js";import{o as S}from"./status-2cad2f88.js";import{S as y}from"./react-select.esm-7abf61d7.js";import"./IconThumbUp-91d06cd2.js";import"./IconTrash-43205dbe.js";import"./objectWithoutPropertiesLoose-f3b3ace0.js";import"./extends-4c19d496.js";import"./floating-ui.dom.browser.min-b8726d47.js";const u={createApi:`${c()}/users/create_user`,roleApi:`${c()}/users/get_user_role`,listApi:`${c()}/users/user_list`,destoryApi:`${c()}/users/delete_user`,updateApi:`${c()}/users/update_user`},z=()=>{const h=j(),m=l.useRef({userformRef:null}),[f,b]=l.useState([]),[R,O]=l.useState(null),[t,g]=l.useState({}),[A,F]=l.useState(null),[E,$]=l.useState(null),x=l.useRef(!1);l.useEffect(()=>{x.current||(h(B("Create User")),D(),N(),x.current=!0)},[h]),(Array.isArray(f)?f:[]).map((s,r)=>{var n;return{id:s.client_user_id,client_user_name:s.client_user_name,client_user_email:s.client_user_email,client_role:(n=s.roles[0])==null?void 0:n.name,user:s}});const D=async()=>{var s;try{const r=await d.get(u.roleApi);if(r.data){const n=r.data.map(o=>({value:o.id,label:o.name}));F(n)}}catch(r){((s=r.response)==null?void 0:s.status)===403&&(window.location.href="/error"),p()}},N=async()=>{var s;try{const r=await d.get(u.listApi);r.data&&b(r.data)}catch(r){((s=r.response)==null?void 0:s.status)===403&&(window.location.href="/error"),p()}},P=async s=>{var r,n,o;s.preventDefault();try{if(m.current.userformRef){const i=new FormData(m.current.userformRef),w=i.get("client_user_id"),_=w?await d.post(`${u.updateApi}/${w}`,i):await d.post(u.createApi,i);(_.status===200||_.status===201)&&(U(_.data.message),N(),g({}),m.current.userformRef.reset())}}catch(i){(n=(r=i.response)==null?void 0:r.data)!=null&&n.errors?g(i.response.data.errors):((o=i.response)==null?void 0:o.status)===403?window.location.href="/error":p()}},U=s=>{v.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:s,icon:"success"})},p=()=>{v.fire({text:"Something went wrong on the server",icon:"error",title:"Server Error"})},C=s=>{$(s)};return e("form",{ref:s=>m.current.userformRef=s,onSubmit:P,className:"space-y-5",children:a("div",{className:"flex flex-wrap -mx-4",children:[e("div",{className:"w-full lg:w-1/3 px-4",children:e("div",{className:"panel",children:e("div",{className:"panel-body",children:a("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a("div",{className:"form-group",children:[e("label",{htmlFor:"client_user_name",children:"Username"}),e("input",{name:"client_user_name",type:"text",placeholder:"Username",className:"form-input"}),e("input",{type:"hidden",name:"client_user_id",id:"client_user_id"}),t.client_user_name&&e("span",{className:"text-red-500 text-sm",children:t.client_user_name})]}),a("div",{className:"form-group",children:[e("label",{htmlFor:"client_user_phone",children:"Phone"}),e("input",{name:"client_user_phone",type:"tel",placeholder:"Phone",className:"form-input"}),t.client_user_phone&&e("span",{className:"text-red-500 text-sm",children:t.client_user_phone})]}),a("div",{className:"form-group",children:[e("label",{htmlFor:"client_user_designation",children:"Designation"}),e("input",{name:"client_user_designation",type:"text",placeholder:"Designation",className:"form-input"}),t.client_user_designation&&e("span",{className:"text-red-500 text-sm",children:t.client_user_designation})]}),a("div",{className:"form-group",children:[e("label",{htmlFor:"client_user_email",children:"Email"}),e("input",{name:"client_user_email",type:"email",placeholder:"Email",className:"form-input"}),t.client_user_email&&e("span",{className:"text-red-500 text-sm",children:t.client_user_email})]}),a("div",{className:"form-group",children:[e("label",{htmlFor:"password",children:"Password"}),e("input",{name:"password",type:"password",placeholder:"Password",className:"form-input"}),t.password&&e("span",{className:"text-red-500 text-sm",children:t.password})]}),a("div",{className:"form-group",children:[e("label",{htmlFor:"client_user_status",children:"Status"}),e(y,{name:"client_user_status",placeholder:"Select an option",options:S,value:S.find(s=>s.value===R)}),t.client_user_status&&e("span",{className:"text-red-500 text-sm",children:t.client_user_status})]}),a("div",{className:"form-group",children:[e("label",{htmlFor:"client_sort_order",children:"Sort Order"}),e("input",{name:"client_sort_order",type:"text",placeholder:"Sort Order",className:"form-input"}),t.client_sort_order&&e("span",{className:"text-red-500 text-sm",children:t.client_sort_order})]}),a("div",{className:"form-group",children:[e("label",{htmlFor:"role_id",children:"Role"}),e(y,{name:"role_id",placeholder:"Select an option",options:A||[],value:E,onChange:C})]}),t.role_id&&e("span",{className:"text-red-500 text-sm",children:t.role_id}),e("div",{className:"sm:col-span-2 flex justify-end",children:e("button",{type:"submit",className:"btn btn-primary",children:"Submit"})})]})})})}),e("div",{className:"w-full lg:w-2/3 px-2 mt-6 lg:mt-0 md-mt-0"})]})})};export{z as default};
