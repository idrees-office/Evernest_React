import{X as y,u as Y,r,s as H,Y as d,S as x,b as t,j as i}from"./index-b04034ff.js";import{I as Q}from"./IconTrashLines-639aceb5.js";import{I as V}from"./IconPencil-0e955efc.js";import{T as U}from"./Table-0718052f.js";/* empty css                  */import"./index-8b111ba5.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./extends-4c19d496.js";const u={createApi:`${y()}/announcements/store`,listApi:`${y()}/announcements/show`,destoryApi:`${y()}/announcements/delete`},ee=()=>{Y();const c=r.useRef({userformRef:null}),[R,C]=r.useState([]),[b,v]=r.useState({});r.useState(null);const[X,P]=r.useState(null);r.useRef(!1);const[m,p]=r.useState(1),[f,T]=r.useState(10),[_,$]=r.useState(0),[l,D]=r.useState({columnAccessor:"client_user_id",direction:"asc"}),[h,k]=r.useState("");r.useEffect(()=>{H("Create Announcements"),g()},[m,f,l,h]);const g=async()=>{var e;try{const s={page:m,per_page:f,sort_field:l.columnAccessor,sort_order:l.direction,search:h},n=await d.get(u.listApi,{params:s});n.data&&(console.log(n.data.data),C(n.data.data||[]),$(n.data.data.length||0))}catch(s){((e=s.response)==null?void 0:e.status)===403&&(window.location.href="/error"),w()}},B=async e=>{var s,n,a;e.preventDefault();try{if(c.current.userformRef){const o=new FormData(c.current.userformRef),A=o.get("announcements_id"),S=A?await d.post(`${u.createApi}/${A}`,o):await d.post(u.createApi,o);(S.status===200||S.status===201)&&(N(S.data.message),g(),v({}),c.current.userformRef.reset(),P(null))}}catch(o){(n=(s=o.response)==null?void 0:s.data)!=null&&n.errors?v(o.response.data.errors):((a=o.response)==null?void 0:a.status)===403||w()}},N=e=>{x.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,title:e,icon:"success"})},w=()=>{x.fire({text:"Something went wrong on the server",icon:"error",title:"Server Error"})},E=async e=>{if(c.current.userformRef){const s=c.current.userformRef;s.reset(),s.announcements_id.value=e.id||"",s.title.value=e.title||"",s.description.value=e.description||""}},I=async e=>{var n;if((await x.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel!"})).isConfirmed)try{const a=await d.delete(u.destoryApi+`/${e.id}`);(a.status===200||a.status===201)&&(N("Announcements deleted successfully"),g())}catch(a){((n=a.response)==null?void 0:n.status)===403&&(window.location.href="/error"),w()}},j=e=>{k(e.target.value),p(1)},L=e=>{p(e)},z=e=>{T(e),p(1)},F=[{accessor:"id",title:"#",width:80,key:"id"},{accessor:"title",title:"Title",sortable:!0,key:"title"},{accessor:"created_at",title:"Date",sortable:!0,key:"created_at"},{accessor:"actions",title:"Actions",width:120,key:"actions-column",render:e=>i("div",{className:"flex space-x-2",children:[t("button",{type:"button",onClick:()=>E(e),className:"btn px-1 py-0.5 rounded text-white bg-info",children:t(V,{})},`edit-${e.id}`),t("button",{type:"button",onClick:()=>I(e),className:"btn px-1 py-0.5 rounded text-white bg-red-600",children:t(Q,{})},`delete-${e.id}`)]})}];return t("form",{ref:e=>c.current.userformRef=e,onSubmit:B,className:"space-y-5",children:i("div",{className:"flex flex-wrap -mx-4",children:[t("div",{className:"w-full lg:w-1/3 px-4",children:t("div",{className:"panel",children:t("div",{className:"panel-body",children:i("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i("div",{className:"form-group sm:col-span-2",children:[t("label",{htmlFor:"title",children:"Announcements Title"}),t("input",{name:"title",type:"text",placeholder:"Title",className:"form-input"}),t("input",{type:"text",name:"announcements_id",id:"announcements_id"}),b.title&&t("span",{className:"text-red-500 text-sm",children:b.title})]}),i("div",{className:"form-group sm:col-span-2",children:[t("label",{htmlFor:"description",children:"Announcements Description"}),t("textarea",{name:"description",id:"description",className:"form-input",style:{height:"316px"},defaultValue:"Hi, "})]}),t("div",{className:"sm:col-span-2 flex justify-end",children:t("button",{type:"submit",className:"btn btn-success w-full",children:" Submit "})})]})})})}),t("div",{className:"w-full lg:w-2/3 px-2 mt-6 lg:mt-0 md-mt-0",children:t("div",{className:"datatables",children:t(U,{columns:F,rows:R,title:"List of all Announcements",idAccessor:"id",totalRecords:_,currentPage:m,recordsPerPage:f,onPageChange:L,onRecordsPerPageChange:z,onSortChange:D,onSearchChange:j,sortStatus:l,isLoading:!1,minHeight:200,noRecordsText:"No users found",searchValue:h})})})]})})};export{ee as default};
