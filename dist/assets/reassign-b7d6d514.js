import{u as A,c as R,T as C,r as l,s as T,a1 as h,b as P,a as c,j as s,$ as U,a0 as F}from"./index-5883d406.js";import{T as j}from"./Table-628e0887.js";import{I as E}from"./IconBell-fa2160c9.js";import{I as M}from"./IconPlus-65a13cbc.js";import{I as W}from"./IconTrash-6985d82f.js";import{L as B}from"./loader-21f6a042.js";import{S as z}from"./react-select.esm-57918e18.js";import{L as H}from"./LeadModal-3baf5550.js";/* empty css                  */import"./index-ec7ab6e9.js";import"./floating-ui.dom.browser.min-b8726d47.js";import"./extends-4c19d496.js";import"./_baseIsEqual-2a9a5d61.js";import"./objectWithoutPropertiesLoose-f3b3ace0.js";import"./transition-f26b7762.js";const re=()=>{const n=A();R();const i=C(),N=B(),b=l.useRef({fetched:!1,form:null}),[o,d]=l.useState([]),[v,m]=l.useState(!0),[k,f]=l.useState(!1);l.useEffect(()=>{b.current.fetched||(n(T("Re-Assign Leads")),n(h()),b.current.fetched=!0)},[n]);const{leads:g,loading:x,agents:u}=P(e=>e.leadslices),_=u==null?void 0:u.map(e=>({value:e==null?void 0:e.client_user_id,label:e==null?void 0:e.client_user_name,phone:e==null?void 0:e.client_user_phone})),y=(Array.isArray(g)?g:[]).map((e,a)=>({id:e.lead_id||"Unknown",title:e.lead_title||"Unknown",name:e.customer_name||"Unknown",phone:e.customer_phone||"Unknown",source:e.lead_source||"Unknown",date:new Intl.DateTimeFormat("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}).format(new Date(e.created_at))})),S=()=>{f(!0)},I=(e,a)=>{a?(d(r=>[...r,e]),m(!1)):(d(r=>r.filter(t=>t.id!==e.id)),o.length===1&&m(!0))},L=async(e,a)=>{if(o.length===0){i.error("Please select at least one lead to assign");return}const r=o.map(p=>p.id),t=new FormData;r.forEach(p=>t.append("lead_id[]",p)),t.append("agent_id",e.toString()),t.append("agent_phone",a.toString());const w=await n(U({formData:t}));(w.payload.status===200||w.payload.status===201)&&(i.success("Leads Have Been Assigned Successfully"),n(h()),d([]),m(!0))},D=async()=>{if(o.length===0){i.error("Please select at least one lead to remove");return}const e=o.map(t=>t.id),a=new FormData;e.forEach(t=>a.append("lead_id[]",t));const r=await n(F({formData:a}));(r.payload.status===200||r.payload.status===201)&&(i.success("Lead removed successfully"),d([]),n(h()),m(!0))};return c("div",{children:[c("div",{className:"panel flex items-center justify-between overflow-visible whitespace-nowrap p-3 text-dark relative",children:[c("div",{className:"flex items-center",children:[s("div",{className:"rounded-full bg-primary p-1.5 text-white ring-2 ring-primary/30 ltr:mr-3 rtl:ml-3",children:s(E,{})}),s("span",{className:"ltr:mr-3 rtl:ml-3",children:" Details of Your Re-Assign Leads: "}),c("button",{onClick:S,className:"btn btn-primary btn-sm",children:[" ",s(M,{})," Add Lead"]})]}),c("div",{className:"flex items-center space-x-2",children:[s(z,{placeholder:"Select an option",options:_,isDisabled:v,className:"cursor-pointer custom-multiselect z-10 w-[300px]",onChange:e=>{(e==null?void 0:e.value)!==void 0&&L(e.value,e.phone)}}),s("button",{onClick:()=>{D()},type:"button",className:"btn btn-danger btn-sm",children:s(W,{})})]})]}),s("div",{className:"datatables mt-6",children:x?N:y.length>0?s(j,{title:"Re-Assign leads",columns:[{accessor:"id",title:"Select",sortable:!1,render:e=>s("input",{type:"checkbox",className:"form-checkbox",checked:o.some(a=>a.id===e.id),onChange:a=>I(e,a.target.checked)})},{accessor:"title",title:"Title",sortable:!0},{accessor:"name",title:"Name",sortable:!0},{accessor:"phone",title:"Phone",sortable:!0},{accessor:"source",title:"Source",sortable:!0,render:e=>e.source==="Facebook"?s("span",{className:"badge bg-info",children:"Facebook"}):e.source==="Instagram"?s("span",{className:"badge bg-secondary",children:"Instagram"}):e.source==="created own"?s("span",{className:"badge bg-success",children:"Created own"}):e.source==="Website"?s("span",{className:"badge bg-warning",children:"Website"}):e.source==="Reshuffle"?s("span",{className:"badge bg-primary",children:"Reshuffle"}):e.source==="Walk-in"?s("span",{className:"badge bg-danger",children:"Walk-in"}):e.source==="Other"?s("span",{className:"badge bg-secondary",children:"Other"}):s("span",{className:"badge bg-secondary",children:"Unknown"})},{accessor:"date",title:"Date",sortable:!0}],rows:y}):s("div",{className:"panel text-center text-primary-500 mt-4",children:s("span",{className:"badge bg-secondary",children:" Sorry, I am unable to retrieve data. Please check your API . "})})}),s(H,{isOpen:k,onClose:()=>f(!1)})]})};export{re as default};
